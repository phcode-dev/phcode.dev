define(function(require,exports){const Dialogs=brackets.getModule("widgets/Dialogs"),Mustache=brackets.getModule("thirdparty/mustache/mustache"),Preferences=require("./Preferences"),Strings=brackets.getModule("strings"),Git=require("./git/Git"),Setup=require("src/utils/Setup"),settingsDialogTemplate=require("text!templates/git-settings-dialog.html");var dialog,$dialog;function setValues(values){$("*[settingsProperty]",$dialog).each(function(){var $this=$(this),type=$this.attr("type"),tag=$this.prop("tagName").toLowerCase(),property=$this.attr("settingsProperty");"checkbox"===type?$this.prop("checked",values[property]):"select"===tag?$("option[value="+values[property]+"]",$this).prop("selected",!0):$this.val(values[property])})}function collectDialogValues(){$("*[settingsProperty]",$dialog).each(function(){var $this=$(this),type=$this.attr("type"),property=$this.attr("settingsProperty"),prefType=Preferences.getType(property);if("checkbox"===type)Preferences.set(property,$this.prop("checked"));else if("number"===prefType){var newValue=parseInt($this.val().trim(),10);isNaN(newValue)&&(newValue=Preferences.getDefaults()[property]),Preferences.set(property,newValue)}else Preferences.set(property,$this.val().trim()||null)}),Preferences.save()}function assignActions(){var $useDifftoolCheckbox=$("#git-settings-useDifftool",$dialog);Git.getConfig("diff.tool").then(function(diffToolConfiguration){diffToolConfiguration?$useDifftoolCheckbox.prop({disabled:!1}):$useDifftoolCheckbox.prop({checked:!1,disabled:!0})}).catch(function(){$useDifftoolCheckbox.prop({checked:!1,disabled:!0})}),$("#git-settings-stripWhitespaceFromCommits",$dialog).on("change",function(){var on=$(this).is(":checked");$("#git-settings-addEndlineToTheEndOfFile,#git-settings-removeByteOrderMark,#git-settings-normalizeLineEndings",$dialog).prop("checked",on).prop("disabled",!on)}),$("button[data-button-id='defaults']",$dialog).on("click",function(e){e.stopPropagation(),setValues(Preferences.getDefaults())})}function init(){setValues(Preferences.getAll()),assignActions()}exports.show=function(){const enableGitPreference=Preferences.get("enableGit"),compiledTemplate=Mustache.render(settingsDialogTemplate,{Strings:Strings,gitDisabled:!enableGitPreference,gitNotFound:!!enableGitPreference&&!Setup.isExtensionActivated()});dialog=Dialogs.showModalDialogUsingTemplate(compiledTemplate),$dialog=dialog.getElement(),init(),$dialog.find("#git-settings-enableGit").on("change",function(){const anyChecked=$dialog.find("#git-settings-enableGit:checked").length>0;anyChecked?$dialog.find(".git-settings-content").removeClass("forced-inVisible"):$dialog.find(".git-settings-content").addClass("forced-inVisible")}),dialog.done(function(buttonId){"ok"===buttonId&&collectDialogValues()})}});
//# sourceMappingURL=SettingsDialog.js.map
