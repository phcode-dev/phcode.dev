{"version":3,"sources":["extensions/default/Git/src/dialogs/Clone.js"],"names":["define","require","exports","Dialogs","brackets","getModule","Mustache","RemoteCommon","Strings","template","$cloneInput","_attachEvents","$dialog","on","$authInputs","find","$","this","val","length","test","prop","auth","exec","focus","show","Promise","resolve","reject","templateArgs","modeLabel","CLONE_REPOSITORY","compiledTemplate","render","dialog","showModalDialogUsingTemplate","getElement","done","buttonId","cloneConfig","remote","remoteUrl","collectValues"],"mappings":"AAAAA,OAAO,SAAUC,QAASC,SAGtB,MAAMC,QAAUC,SAASC,UAAU,mBAC/BC,SAAWF,SAASC,UAAU,gCAG5BE,aAAkBN,QAAQ,4BAC5BO,QAAoBJ,SAASC,UAAU,WAGrCI,SAAsBR,QAAQ,gDAGpC,IAAIS,YAGJ,SAASC,cAAcC,SAEnBF,YAAYG,GAAG,eAAgB,WAC3B,IAAIC,YAAcF,QAAQG,KAAK,yEAC/B,GAAIC,EAAEC,MAAMC,MAAMC,OAAS,EACvB,GAAI,WAAWC,KAAKJ,EAAEC,MAAMC,OAAQ,CAChCJ,YAAYO,KAAK,YAAY,GAG7B,IAAIC,KAAO,yBAAyBC,KAAKP,EAAEC,MAAMC,OAC7CI,OACAN,EAAE,uBAAwBJ,SAASM,IAAII,KAAK,IAC5CN,EAAE,uBAAwBJ,SAASM,IAAII,KAAK,UAGhDR,YAAYO,KAAK,YAAY,QAGjCP,YAAYO,KAAK,YAAY,KAGrCX,YAAYc,QAGhB,SAASC,OACL,OAAO,IAAIC,QAAQ,CAACC,QAASC,UACzB,MAAMC,aAAe,CACjBC,UAAWtB,QAAQuB,iBACnBvB,QAASA,SAGb,IAAIwB,iBAAmB1B,SAAS2B,OAAOxB,SAAUoB,cAC7CK,OAAS/B,QAAQgC,6BAA6BH,kBAC9CpB,QAAUsB,OAAOE,aAErB1B,YAAcE,QAAQG,KAAK,kBAE3BJ,cAAcC,SAEdsB,OAAOG,KAAK,SAAUC,UAClB,GAAiB,OAAbA,SAAmB,CACnB,IAAIC,YAAc,CAClBC,OAAqB,UACrBD,YAAYE,UAAY/B,YAAYQ,MACpCX,aAAamC,cAAcH,YAAa3B,SACxCe,QAAQY,kBAERX,aAOhB1B,QAAQuB,KAAOA","sourcesContent":["define(function (require, exports) {\n\n    // Brackets modules\n    const Dialogs = brackets.getModule(\"widgets/Dialogs\"),\n        Mustache = brackets.getModule(\"thirdparty/mustache/mustache\");\n\n    // Local modules\n    const RemoteCommon    = require(\"src/dialogs/RemoteCommon\"),\n        Strings           = brackets.getModule(\"strings\");\n\n    // Templates\n    const template            = require(\"text!src/dialogs/templates/clone-dialog.html\");\n\n    // Module variables\n    let $cloneInput;\n\n    // Implementation\n    function _attachEvents($dialog) {\n        // Detect changes to URL, disable auth if not http\n        $cloneInput.on(\"keyup change\", function () {\n            var $authInputs = $dialog.find(\"input[name='username'],input[name='password'],input[name='saveToUrl']\");\n            if ($(this).val().length > 0) {\n                if (/^https?:/.test($(this).val())) {\n                    $authInputs.prop(\"disabled\", false);\n\n                    // Update the auth fields if the URL contains auth\n                    var auth = /:\\/\\/([^:]+):?([^@]*)@/.exec($(this).val());\n                    if (auth) {\n                        $(\"input[name=username]\", $dialog).val(auth[1]);\n                        $(\"input[name=password]\", $dialog).val(auth[2]);\n                    }\n                } else {\n                    $authInputs.prop(\"disabled\", true);\n                }\n            } else {\n                $authInputs.prop(\"disabled\", false);\n            }\n        });\n        $cloneInput.focus();\n    }\n\n    function show() {\n        return new Promise((resolve, reject)=>{\n            const templateArgs = {\n                modeLabel: Strings.CLONE_REPOSITORY,\n                Strings: Strings\n            };\n\n            var compiledTemplate = Mustache.render(template, templateArgs),\n                dialog = Dialogs.showModalDialogUsingTemplate(compiledTemplate),\n                $dialog = dialog.getElement();\n\n            $cloneInput = $dialog.find(\"#git-clone-url\");\n\n            _attachEvents($dialog);\n\n            dialog.done(function (buttonId) {\n                if (buttonId === \"ok\") {\n                    var cloneConfig = {};\n                    cloneConfig.remote = \"origin\";\n                    cloneConfig.remoteUrl = $cloneInput.val();\n                    RemoteCommon.collectValues(cloneConfig, $dialog);\n                    resolve(cloneConfig);\n                } else {\n                    reject();\n                }\n            });\n\n        });\n    }\n\n    exports.show = show;\n});\n"],"file":"Clone.js"}