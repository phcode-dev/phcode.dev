{"version":3,"sources":["extensionsIntegrated/TabBar/main.js"],"names":["define","require","exports","module","_","AppInit","MainViewManager","FileSystem","PreferencesManager","FileUtils","CommandManager","Commands","DocumentManager","WorkspaceManager","Menus","Strings","Global","Helper","Preference","MoreOptions","Overflow","DragDrop","TabBarHTML","TabBarHTML2","$tabBar","$tabBar2","isTabBarActive","tabBarEnabled","tabBarNumberOfTabs","getAllFilesFromWorkingSet","firstPaneWorkingSet","secondPaneWorkingSet","paneList","getPaneIdList","length","currFirstPaneWorkingSet","getWorkingSet","i","push","_getRequiredDataFromEntry","_handleDuplicateFileNames","currSecondPaneWorkingSet","forEach","entry","doc","getOpenDocumentForPath","path","isDirty","createTab","paneId","activeFileInPane","getCurrentlyViewedFile","activePathInPane","fullPath","isActive","currentActivePane","getActivePaneId","isPaneActive","_isFileModified","getFileForPath","isPlaceholder","gitStatus","gitStatusClass","window","phoenixGitEvents","TabBarIntegration","isUntracked","isModified","$tab","$","Phoenix","app","getDisplayPath","$icon","_getFileIcon","find","append","$tabName","displayName","name","parts","split","dirName","fileName","html","text","addClass","removeClass","createTabBar","cleanupTabBar","$paneHeader","after","attr","TABBAR_SHOW_HIDDEN_TABS","recomputeLayout","updateTabs","eq","activePane","firstPaneFile","secondPaneFile","firstPanePlaceholder","secondPanePlaceholder","some","hasDuplicate","parentDir","getDirectoryPath","dirParts","parentDirName","is","$firstTabBar","empty","tabsCountP1","Math","min","displayedEntries","activeFileIndex","findIndex","slice","$secondTabBar","tabsCountP2","displayedEntries2","_hideTabBar","toggleOverflowVisibility","setTimeout","scrollToActiveTab","init","remove","handleTabClick","document","on","event","filePath","this","isSecondPane","closest","fileObj","target","hasClass","preventDefault","stopPropagation","execute","FILE_CLOSE","file","currentFile","addToWorkingSet","FILE_OPEN","showMoreOptionsContextMenu","pageX","pageY","debounceUpdateTabs","debounce","onFileSave","commandId","FILE_SAVE","FILE_SAVE_ALL","isFirstPanePlaceholder","isSecondPanePlaceholder","_registerHandlers","EVENT_CURRENT_FILE_CHANGE","EventEmitter","events","off","join","ResizeObserver","observe","toggleClass","$tab2","preferenceChanged","prefs","get","PREFERENCES_TAB_BAR","showTabBar","numberOfTabs","TOGGLE_TABBAR","setChecked","_registerCommands","register","CMD_TOGGLE_TABBAR","currentPref","set","setupTabBarScrolling","handleMouseWheel","e","$scrolledTabBar","scrollAmount","originalEvent","deltaY","newScrollLeft","scrollLeft","appReady","viewMenu","getMenu","AppMenuBar","VIEW_MENU","addMenuItem","AFTER","VIEW_HIDE_SIDEBAR"],"mappings":"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","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n/* eslint-disable no-invalid-this */\ndefine(function (require, exports, module) {\n    const _ = require(\"thirdparty/lodash\");\n    const AppInit = require(\"utils/AppInit\");\n    const MainViewManager = require(\"view/MainViewManager\");\n    const FileSystem = require(\"filesystem/FileSystem\");\n    const PreferencesManager = require(\"preferences/PreferencesManager\");\n    const FileUtils = require(\"file/FileUtils\");\n    const CommandManager = require(\"command/CommandManager\");\n    const Commands = require(\"command/Commands\");\n    const DocumentManager = require(\"document/DocumentManager\");\n    const WorkspaceManager = require(\"view/WorkspaceManager\");\n    const Menus = require(\"command/Menus\");\n    const Strings = require(\"strings\");\n\n    const Global = require(\"./global\");\n    const Helper = require(\"./helper\");\n    const Preference = require(\"./preference\");\n    const MoreOptions = require(\"./more-options\");\n    const Overflow = require(\"./overflow\");\n    const DragDrop = require(\"./drag-drop\");\n    const TabBarHTML = require(\"text!./html/tabbar-pane.html\");\n    const TabBarHTML2 = require(\"text!./html/tabbar-second-pane.html\");\n\n    /**\n     * This holds the tab bar element\n     * For tab bar structure, refer to `./html/tabbar-pane.html` and `./html/tabbar-second-pane.html`\n     * $tabBar is for the first pane and $tabBar2 is for the second pane\n     *\n     * @type {$.Element}\n     */\n    let $tabBar = null;\n    let $tabBar2 = null;\n\n    /**\n     * this function checks if the TabBar is currently enabled or not (no. of tabs is 0 means tab bar is disabled)\n     * @returns {boolean} true if TabBar is enabled and should be active\n     */\n    function isTabBarActive() {\n        return Preference.tabBarEnabled && Preference.tabBarNumberOfTabs !== 0;\n    }\n\n    /**\n     * This function is responsible to take all the files from the working set and gets the working sets ready\n     * This is placed here instead of helper.js because it modifies the working sets\n     */\n    function getAllFilesFromWorkingSet() {\n        if (!isTabBarActive()) {\n            return;\n        }\n\n        Global.firstPaneWorkingSet = [];\n        Global.secondPaneWorkingSet = [];\n\n        // this gives the list of panes. When both panes are open, it will be ['first-pane', 'second-pane']\n        const paneList = MainViewManager.getPaneIdList();\n\n        // to make sure atleast one pane is open\n        if (paneList && paneList.length > 0) {\n            // this gives the working set of the first pane\n            const currFirstPaneWorkingSet = MainViewManager.getWorkingSet(paneList[0]);\n\n            for (let i = 0; i < currFirstPaneWorkingSet.length; i++) {\n                // MainViewManager.getWorkingSet gives the working set of the first pane,\n                // but it has lot of details we don't need. Hence we use Helper._getRequiredDataFromEntry\n                Global.firstPaneWorkingSet.push(Helper._getRequiredDataFromEntry(currFirstPaneWorkingSet[i]));\n            }\n            // if there are duplicate file names, we update the displayName to include the directory\n            Helper._handleDuplicateFileNames(Global.firstPaneWorkingSet);\n\n            // check if second pane is open\n            if (paneList.length > 1) {\n                const currSecondPaneWorkingSet = MainViewManager.getWorkingSet(paneList[1]);\n\n                for (let i = 0; i < currSecondPaneWorkingSet.length; i++) {\n                    Global.secondPaneWorkingSet.push(Helper._getRequiredDataFromEntry(currSecondPaneWorkingSet[i]));\n                }\n                Helper._handleDuplicateFileNames(Global.secondPaneWorkingSet);\n            }\n\n            // Update dirty status for files in the first pane working set\n            Global.firstPaneWorkingSet.forEach(function (entry) {\n                const doc = DocumentManager.getOpenDocumentForPath(entry.path);\n                if (doc) {\n                    entry.isDirty = doc.isDirty;\n                }\n            });\n\n            // Update dirty status for files in the second pane working set\n            Global.secondPaneWorkingSet.forEach(function (entry) {\n                const doc = DocumentManager.getOpenDocumentForPath(entry.path);\n                if (doc) {\n                    entry.isDirty = doc.isDirty;\n                }\n            });\n        }\n    }\n\n    /**\n     * Responsible for creating the tab element\n     * Note: this creates a tab (for a single file) not the tab bar\n     *\n     * @param {Object} entry - the working set entry\n     * @param {String} paneId - the pane id 'first-pane' or 'second-pane'\n     * @returns {$.Element} the tab element\n     */\n    function createTab(entry, paneId) {\n        if (!$tabBar || !paneId) {\n            return;\n        }\n\n        // get the current active file for this specific pane\n        const activeFileInPane = MainViewManager.getCurrentlyViewedFile(paneId);\n        const activePathInPane = activeFileInPane ? activeFileInPane.fullPath : null;\n\n        // Check if this file is active in its pane\n        const isActive = entry.path === activePathInPane;\n\n        // Current active pane (used to determine whether to add the blue underline)\n        const currentActivePane = MainViewManager.getActivePaneId();\n        const isPaneActive = paneId === currentActivePane;\n\n        const isDirty = Helper._isFileModified(FileSystem.getFileForPath(entry.path));\n        const isPlaceholder = entry.isPlaceholder === true;\n\n        let gitStatus = \"\"; // this will be shown in the tooltip when a tab is hovered\n        let gitStatusClass = \"\"; // for styling\n\n        if (window.phoenixGitEvents && window.phoenixGitEvents.TabBarIntegration) {\n            const TabBarIntegration = window.phoenixGitEvents.TabBarIntegration;\n\n            // find the Git status\n            // if untracked we add the git-new class and U char\n            // if modified we add the git-modified class and M char\n            if (TabBarIntegration.isUntracked(entry.path)) {\n                gitStatus = \"Untracked\";\n                gitStatusClass = \"git-new\";\n            } else if (TabBarIntegration.isModified(entry.path)) {\n                gitStatus = \"Modified\";\n                gitStatusClass = \"git-modified\";\n            }\n        }\n\n        // create tab with all the appropriate classes\n        const $tab = $(\n            `<div class=\"tab \n            ${isActive ? \"active\" : \"\"}\n            ${isDirty ? \"dirty\" : \"\"}\n            ${isPlaceholder ? \"placeholder\" : \"\"}\n            ${gitStatusClass}\"\n            data-path=\"${entry.path}\" \n            title=\"${Phoenix.app.getDisplayPath(entry.path)}${gitStatus ? \" (\" + gitStatus + \")\" : \"\"}\">\n            <div class=\"tab-icon\"></div>\n            <div class=\"tab-name\"></div>\n            <div class=\"tab-close\"><i class=\"fa-solid fa-times\"></i></div>\n        </div>`\n        );\n\n        // Add the file icon\n        const $icon = Helper._getFileIcon(entry);\n        $tab.find(\".tab-icon\").append($icon);\n\n        // Check if we have a directory part in the displayName\n        const $tabName = $tab.find(\".tab-name\");\n        if (entry.displayName && entry.displayName !== entry.name) {\n            // Split the displayName into directory and filename parts\n            const parts = entry.displayName.split(\"/\");\n            const dirName = parts[0];\n            const fileName = parts[1];\n\n            // create the HTML for different styling for directory and filename\n            $tabName.html(`<span class=\"tab-dirname\">${dirName}/</span>${fileName}`);\n        } else {\n            // Just the filename\n            $tabName.text(entry.name);\n        }\n\n        // only add the underline class if this is both active AND in the active pane\n        if (isActive && !isPaneActive) {\n            // if it's active but in a non-active pane, we add a special class\n            // to style differently in CSS to indicate that it's active but not in the active pane\n            $tab.addClass(\"active-in-inactive-pane\");\n        }\n\n        // if this is a placeholder tab in inactive pane, we need to use the brown styling\n        // instead of the blue one for active tabs\n        if (isPlaceholder && isActive && !isPaneActive) {\n            $tab.removeClass(\"active\");\n            $tab.addClass(\"active-in-inactive-pane\");\n        }\n\n        return $tab;\n    }\n\n    /**\n     * Creates the tab bar and adds it to the DOM\n     */\n    function createTabBar() {\n        if (!isTabBarActive()) {\n            cleanupTabBar();\n            return;\n        }\n\n        // clean up any existing tab bars first and start fresh\n        cleanupTabBar();\n\n        const $paneHeader = $(\".pane-header\");\n        if ($paneHeader.length === 1) {\n            $tabBar = $(TabBarHTML);\n            // since we need to add the tab bar before the editor which has .not-editor class\n            $(\".pane-header\").after($tabBar);\n            $(\"#overflow-button\").attr(\"title\", Strings.TABBAR_SHOW_HIDDEN_TABS);\n            WorkspaceManager.recomputeLayout(true);\n            updateTabs();\n        } else if ($paneHeader.length === 2) {\n            $tabBar = $(TabBarHTML);\n            $tabBar2 = $(TabBarHTML2);\n\n            // eq(0) is for the first pane and eq(1) is for the second pane\n            // TODO: Fix bug where the tab bar gets hidden inside the editor in horizontal split\n            $paneHeader.eq(0).after($tabBar);\n            $paneHeader.eq(1).after($tabBar2);\n            $(\"#overflow-button\").attr(\"title\", Strings.TABBAR_SHOW_HIDDEN_TABS);\n            $(\"#overflow-button-2\").attr(\"title\", Strings.TABBAR_SHOW_HIDDEN_TABS);\n            WorkspaceManager.recomputeLayout(true);\n            updateTabs();\n        }\n    }\n\n    /**\n     * This function updates the tabs in the tab bar\n     * It is called when the working set changes. So instead of creating a new tab bar, we just update the existing one\n     */\n    function updateTabs() {\n        if (!isTabBarActive()) {\n            return;\n        }\n\n        // Get all files from the working set. refer to `global.js`\n        getAllFilesFromWorkingSet();\n\n        // just to make sure that the number of tabs is not set to 0\n        if (Preference.tabBarNumberOfTabs === 0) {\n            cleanupTabBar();\n            return;\n        }\n\n        // Check for active files not in working set in any pane\n        const activePane = MainViewManager.getActivePaneId();\n        const firstPaneFile = MainViewManager.getCurrentlyViewedFile(\"first-pane\");\n        const secondPaneFile = MainViewManager.getCurrentlyViewedFile(\"second-pane\");\n\n        // when a file is opened from the filetree and is not present in the working set, then it is a placeholder\n        let firstPanePlaceholder = null;\n        let secondPanePlaceholder = null;\n\n        // Check if active file in first pane is not in the working set\n        if (firstPaneFile && !Global.firstPaneWorkingSet.some((entry) => entry.path === firstPaneFile.fullPath)) {\n            firstPanePlaceholder = {\n                path: firstPaneFile.fullPath,\n                name: firstPaneFile.name,\n                isPlaceholder: true,\n                displayName: firstPaneFile.name // for now we initialize with name, will check for duplicates later\n            };\n        }\n\n        // Check if active file in second pane is not in the working set\n        if (secondPaneFile && !Global.secondPaneWorkingSet.some((entry) => entry.path === secondPaneFile.fullPath)) {\n            secondPanePlaceholder = {\n                path: secondPaneFile.fullPath,\n                name: secondPaneFile.name,\n                isPlaceholder: true,\n                displayName: secondPaneFile.name\n            };\n        }\n\n        // check for duplicate file names between placeholder tabs and working set entries\n        if (firstPanePlaceholder) {\n            // if any working set file has the same name as the placeholder\n            const hasDuplicate = Global.firstPaneWorkingSet.some((entry) => entry.name === firstPanePlaceholder.name);\n\n            if (hasDuplicate) {\n                // extract directory name from path\n                const path = firstPanePlaceholder.path;\n                const parentDir = FileUtils.getDirectoryPath(path);\n                const dirParts = parentDir.split(\"/\");\n                const parentDirName = dirParts[dirParts.length - 2] || \"\";\n\n                // Update displayName with directory\n                firstPanePlaceholder.displayName = parentDirName + \"/\" + firstPanePlaceholder.name;\n            }\n        }\n\n        if (secondPanePlaceholder) {\n            const hasDuplicate = Global.secondPaneWorkingSet.some((entry) => entry.name === secondPanePlaceholder.name);\n\n            if (hasDuplicate) {\n                const path = secondPanePlaceholder.path;\n                const parentDir = FileUtils.getDirectoryPath(path);\n                const dirParts = parentDir.split(\"/\");\n                const parentDirName = dirParts[dirParts.length - 2] || \"\";\n\n                secondPanePlaceholder.displayName = parentDirName + \"/\" + secondPanePlaceholder.name;\n            }\n        }\n\n        // Create tab bar if there's a placeholder or a file in the working set\n        if (\n            (Global.firstPaneWorkingSet.length > 0 || firstPanePlaceholder) &&\n            (!$(\"#phoenix-tab-bar\").length || $(\"#phoenix-tab-bar\").is(\":hidden\"))\n        ) {\n            createTabBar();\n        }\n\n        if (\n            (Global.secondPaneWorkingSet.length > 0 || secondPanePlaceholder) &&\n            (!$(\"#phoenix-tab-bar-2\").length || $(\"#phoenix-tab-bar-2\").is(\":hidden\"))\n        ) {\n            createTabBar();\n        }\n\n        const $firstTabBar = $(\"#phoenix-tab-bar\");\n        // Update first pane's tabs\n        if ($firstTabBar.length) {\n            $firstTabBar.empty();\n            if (Global.firstPaneWorkingSet.length > 0 || firstPanePlaceholder) {\n                // get the count of tabs that we want to display in the tab bar (from preference settings)\n                // from preference settings or working set whichever smaller\n                let tabsCountP1 = Math.min(Global.firstPaneWorkingSet.length, Preference.tabBarNumberOfTabs);\n\n                // the value is generally '-1', but we check for less than 0 so that it can handle edge cases gracefully\n                // if the value is negative then we display all tabs\n                if (Preference.tabBarNumberOfTabs < 0) {\n                    tabsCountP1 = Global.firstPaneWorkingSet.length;\n                }\n\n                let displayedEntries = [];\n\n                // check if active file is in the working set but would be excluded by tab count\n                if (firstPaneFile && Preference.tabBarNumberOfTabs > 0) {\n                    const activeFileIndex = Global.firstPaneWorkingSet.findIndex(\n                        (entry) => entry.path === firstPaneFile.fullPath\n                    );\n\n                    if (activeFileIndex >= 0 && activeFileIndex >= Preference.tabBarNumberOfTabs) {\n                        // active file is in working set but would be excluded by tab count\n                        // Show active file and one less from the top N files\n                        displayedEntries = [\n                            ...Global.firstPaneWorkingSet.slice(0, Preference.tabBarNumberOfTabs - 1),\n                            Global.firstPaneWorkingSet[activeFileIndex]\n                        ];\n                    } else {\n                        // Active file is either not in working set or already included in top N files\n                        displayedEntries = Global.firstPaneWorkingSet.slice(0, tabsCountP1);\n                    }\n                } else {\n                    displayedEntries = Global.firstPaneWorkingSet.slice(0, tabsCountP1);\n                }\n\n                // Add working set tabs\n                displayedEntries.forEach(function (entry) {\n                    $firstTabBar.append(createTab(entry, \"first-pane\"));\n                });\n\n                // Add placeholder tab if needed\n                if (firstPanePlaceholder) {\n                    $firstTabBar.append(createTab(firstPanePlaceholder, \"first-pane\"));\n                }\n            }\n        }\n\n        const $secondTabBar = $(\"#phoenix-tab-bar-2\");\n        // Update second pane's tabs\n        if ($secondTabBar.length) {\n            $secondTabBar.empty();\n            if (Global.secondPaneWorkingSet.length > 0 || secondPanePlaceholder) {\n                let tabsCountP2 = Math.min(Global.secondPaneWorkingSet.length, Preference.tabBarNumberOfTabs);\n                if (Preference.tabBarNumberOfTabs < 0) {\n                    tabsCountP2 = Global.secondPaneWorkingSet.length;\n                }\n\n                let displayedEntries2 = [];\n\n                if (secondPaneFile && Preference.tabBarNumberOfTabs > 0) {\n                    const activeFileIndex = Global.secondPaneWorkingSet.findIndex(\n                        (entry) => entry.path === secondPaneFile.fullPath\n                    );\n\n                    if (activeFileIndex >= 0 && activeFileIndex >= Preference.tabBarNumberOfTabs) {\n                        displayedEntries2 = [\n                            ...Global.secondPaneWorkingSet.slice(0, Preference.tabBarNumberOfTabs - 1),\n                            Global.secondPaneWorkingSet[activeFileIndex]\n                        ];\n                    } else {\n                        displayedEntries2 = Global.secondPaneWorkingSet.slice(0, tabsCountP2);\n                    }\n                } else {\n                    displayedEntries2 = Global.secondPaneWorkingSet.slice(0, tabsCountP2);\n                }\n\n                // Add working set tabs\n                displayedEntries2.forEach(function (entry) {\n                    $secondTabBar.append(createTab(entry, \"second-pane\"));\n                });\n\n                // Add placeholder tab if needed\n                if (secondPanePlaceholder) {\n                    $secondTabBar.append(createTab(secondPanePlaceholder, \"second-pane\"));\n                }\n            }\n        }\n\n        // if no files are present in a pane and no placeholder, we want to hide the tab bar for that pane\n        if (Global.firstPaneWorkingSet.length === 0 && !firstPanePlaceholder && $(\"#phoenix-tab-bar\")) {\n            Helper._hideTabBar($(\"#phoenix-tab-bar\"), $(\"#overflow-button\"));\n        }\n\n        if (Global.secondPaneWorkingSet.length === 0 && !secondPanePlaceholder && $(\"#phoenix-tab-bar-2\")) {\n            Helper._hideTabBar($(\"#phoenix-tab-bar-2\"), $(\"#overflow-button-2\"));\n        }\n\n        // Now that tabs are updated, scroll to the active tab if necessary.\n        if ($firstTabBar.length) {\n            Overflow.toggleOverflowVisibility(\"first-pane\");\n\n            // we scroll only in the active pane\n            // this is because, lets say we have a same file in both the panes\n            // then when the file is opened in one of the pane and is towards the end of the tab bar,\n            // then we need to show the scrolling animation only on that pane and not on both the panes\n            if (activePane === \"first-pane\") {\n                setTimeout(function () {\n                    Overflow.scrollToActiveTab($firstTabBar);\n                }, 0);\n            }\n        }\n\n        if ($secondTabBar.length) {\n            Overflow.toggleOverflowVisibility(\"second-pane\");\n            if (activePane === \"second-pane\") {\n                setTimeout(function () {\n                    Overflow.scrollToActiveTab($secondTabBar);\n                }, 0);\n            }\n        }\n\n        // handle drag and drop\n        DragDrop.init($(\"#phoenix-tab-bar\"), $(\"#phoenix-tab-bar-2\"));\n    }\n\n    /**\n     * Removes existing tab bar and cleans up\n     */\n    function cleanupTabBar() {\n        if ($tabBar) {\n            $tabBar.remove();\n            $tabBar = null;\n        }\n        if ($tabBar2) {\n            $tabBar2.remove();\n            $tabBar2 = null;\n        }\n        // Also check for any orphaned tab bars that might exist\n        $(\".tab-bar-container\").remove();\n        WorkspaceManager.recomputeLayout(true);\n    }\n\n    /**\n     * handle click events on the tabs to open the file\n     */\n    function handleTabClick() {\n        // delegate event handling for both tab bars\n        $(document).on(\"click\", \".phoenix-tab-bar .tab\", function (event) {\n            // Get the file path from the data-path attribute of the parent tab\n            const filePath = $(this).attr(\"data-path\");\n            if (!filePath) { return; }\n\n            // determine the pane inside which the tab belongs\n            const isSecondPane = $(this).closest(\"#phoenix-tab-bar-2\").length > 0;\n            const paneId = isSecondPane ? \"second-pane\" : \"first-pane\";\n\n            // get the file object\n            const fileObj = FileSystem.getFileForPath(filePath);\n\n            // check if the clicked element is the close button\n            if ($(event.target).hasClass(\"fa-times\") || $(event.target).closest(\".tab-close\").length) {\n                event.preventDefault();\n                event.stopPropagation();\n\n                CommandManager.execute(Commands.FILE_CLOSE, { file: fileObj, paneId: paneId }); // close the file\n            }\n        });\n\n        // open tab on mousedown event\n        $(document).on(\"mousedown\", \".phoenix-tab-bar .tab\", function (event) {\n            if ($(event.target).hasClass(\"fa-times\") || $(event.target).closest(\".tab-close\").length) {\n                return;\n            }\n\n            // Get the file path from the data-path attribute of the parent tab\n            const filePath = $(this).attr(\"data-path\");\n            if (!filePath) { return; }\n\n            // determine the pane inside which the tab belongs\n            const isSecondPane = $(this).closest(\"#phoenix-tab-bar-2\").length > 0;\n            const paneId = isSecondPane ? \"second-pane\" : \"first-pane\";\n\n            // get the file object\n            const fileObj = FileSystem.getFileForPath(filePath);\n            const currentActivePane = MainViewManager.getActivePaneId();\n            const isPaneActive = paneId === currentActivePane;\n            const currentFile = MainViewManager.getCurrentlyViewedFile(currentActivePane);\n\n            // if the clicked tab is a placeholder tab, we add it to the working set\n            if ($(this).hasClass(\"placeholder\")) {\n                MainViewManager.addToWorkingSet(paneId, fileObj);\n            }\n\n            // clicked tab is already active, don't do anything\n            if (isPaneActive && currentFile && currentFile.fullPath === filePath) { return; }\n            CommandManager.execute(Commands.FILE_OPEN, { fullPath: filePath, paneId: paneId });\n        });\n\n        // Add the contextmenu (right-click) handler\n        $(document).on(\"contextmenu\", \".phoenix-tab-bar .tab\", function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            // get the file path from the data-path attribute\n            const filePath = $(this).attr(\"data-path\");\n\n            // determine which pane the tab belongs to\n            const isSecondPane = $(this).closest(\"#phoenix-tab-bar-2\").length > 0;\n            const paneId = isSecondPane ? \"second-pane\" : \"first-pane\";\n\n            // show the context menu at mouse position\n            MoreOptions.showMoreOptionsContextMenu(paneId, event.pageX, event.pageY, filePath);\n        });\n    }\n\n    // debounce is used to prevent rapid consecutive calls to updateTabs,\n    // which was causing integration tests to fail in Firefox. Without it,\n    // the event fires too frequently when switching editors, leading to unexpected behavior\n    const debounceUpdateTabs = _.debounce(updateTabs, 2);\n\n    /**\n     * This function is responsible to add the placeholder tab to the working set (if user press save on it)\n     * @param {Event} event\n     * @param {String} commandId - the command id, to make sure we check it do the operation only on file save\n     */\n    function onFileSave(event, commandId) {\n        if (!isTabBarActive()) {\n            return;\n        }\n\n        if (commandId === Commands.FILE_SAVE || commandId === Commands.FILE_SAVE_ALL) {\n            const activePane = MainViewManager.getActivePaneId();\n            const currentFile = MainViewManager.getCurrentlyViewedFile(activePane);\n\n            if (currentFile) {\n                const filePath = currentFile.fullPath;\n\n                // check if this file is currently shown as a placeholder in any pane\n                const isFirstPanePlaceholder =\n                    MainViewManager.getCurrentlyViewedFile(\"first-pane\") &&\n                    MainViewManager.getCurrentlyViewedFile(\"first-pane\").fullPath === filePath &&\n                    !Global.firstPaneWorkingSet.some((entry) => entry.path === filePath);\n\n                const isSecondPanePlaceholder =\n                    MainViewManager.getCurrentlyViewedFile(\"second-pane\") &&\n                    MainViewManager.getCurrentlyViewedFile(\"second-pane\").fullPath === filePath &&\n                    !Global.secondPaneWorkingSet.some((entry) => entry.path === filePath);\n\n                // if it's a placeholder tab, we add it to the working set\n                if (isFirstPanePlaceholder) {\n                    const fileObj = FileSystem.getFileForPath(filePath);\n                    MainViewManager.addToWorkingSet(\"first-pane\", fileObj);\n                }\n\n                if (isSecondPanePlaceholder) {\n                    const fileObj = FileSystem.getFileForPath(filePath);\n                    MainViewManager.addToWorkingSet(\"second-pane\", fileObj);\n                }\n            }\n        }\n    }\n\n    /**\n     * Registers the event handlers\n     */\n    function _registerHandlers() {\n        // For pane layout changes, recreate the entire tab bar container\n        MainViewManager.on(\"paneCreate paneDestroy paneLayoutChange\", createTabBar);\n\n        // For active pane changes, update only the tabs\n        MainViewManager.on(\"activePaneChange\", debounceUpdateTabs);\n\n        // For editor changes, update only the tabs.\n        MainViewManager.on(MainViewManager.EVENT_CURRENT_FILE_CHANGE, debounceUpdateTabs);\n\n        // to listen for the Git status changes\n        // make sure that the git extension is available\n        if (window.phoenixGitEvents && window.phoenixGitEvents.EventEmitter) {\n            window.phoenixGitEvents.EventEmitter.on(\"GIT_FILE_STATUS_CHANGED\", debounceUpdateTabs);\n        }\n\n        // For working set changes, update only the tabs.\n        const events = [\n            \"workingSetAdd\",\n            \"workingSetRemove\",\n            \"workingSetSort\",\n            \"workingSetMove\",\n            \"workingSetAddList\",\n            \"workingSetRemoveList\",\n            \"workingSetUpdate\",\n            \"_workingSetDisableAutoSort\"\n        ];\n        MainViewManager.off(events.join(\" \"), updateTabs);\n        MainViewManager.on(events.join(\" \"), updateTabs);\n\n        // When the sidebar UI changes, update the tabs to ensure the overflow menu is correct\n        $(\"#sidebar\").off(\"panelCollapsed panelExpanded panelResizeEnd\", updateTabs);\n        $(\"#sidebar\").on(\"panelCollapsed panelExpanded panelResizeEnd\", updateTabs);\n\n        // also update the tabs when the main plugin panel resizes\n        // main-plugin-panel[0] = live preview panel\n        new ResizeObserver(updateTabs).observe($(\"#main-plugin-panel\")[0]);\n\n        // listen for file save commands, needed to add placeholder tab to the working set\n        CommandManager.off(\"beforeExecuteCommand\", onFileSave);\n        CommandManager.on(\"beforeExecuteCommand\", onFileSave);\n\n        // File dirty flag change handling\n        DocumentManager.on(\"dirtyFlagChange\", function (event, doc) {\n            if (!isTabBarActive()) {\n                return;\n            }\n\n            const filePath = doc.file.fullPath;\n\n            // Update UI\n            if ($tabBar) {\n                const $tab = $tabBar.find(`.tab[data-path=\"${filePath}\"]`);\n                $tab.toggleClass(\"dirty\", doc.isDirty);\n\n                // Update the working set data\n                // First pane\n                for (let i = 0; i < Global.firstPaneWorkingSet.length; i++) {\n                    if (Global.firstPaneWorkingSet[i].path === filePath) {\n                        Global.firstPaneWorkingSet[i].isDirty = doc.isDirty;\n                        break;\n                    }\n                }\n            }\n\n            // Also update the $tab2 if it exists\n            if ($tabBar2) {\n                const $tab2 = $tabBar2.find(`.tab[data-path=\"${filePath}\"]`);\n                $tab2.toggleClass(\"dirty\", doc.isDirty);\n\n                // Second pane\n                for (let i = 0; i < Global.secondPaneWorkingSet.length; i++) {\n                    if (Global.secondPaneWorkingSet[i].path === filePath) {\n                        Global.secondPaneWorkingSet[i].isDirty = doc.isDirty;\n                        break;\n                    }\n                }\n            }\n        });\n    }\n\n    /**\n     * This is called when the tab bar preference is changed either,\n     * from the preferences file or the menu bar\n     * It takes care of creating or cleaning up the tab bar\n     */\n    function preferenceChanged() {\n        const prefs = PreferencesManager.get(Preference.PREFERENCES_TAB_BAR);\n        Preference.tabBarEnabled = prefs.showTabBar;\n        Preference.tabBarNumberOfTabs = prefs.numberOfTabs;\n\n        // Update menu checkmark\n        CommandManager.get(Commands.TOGGLE_TABBAR).setChecked(prefs.showTabBar);\n\n        if (isTabBarActive()) {\n            createTabBar();\n        } else {\n            cleanupTabBar();\n        }\n    }\n\n    /**\n     * Registers the commands,\n     * for toggling the tab bar from the menu bar\n     */\n    function _registerCommands() {\n        CommandManager.register(Strings.CMD_TOGGLE_TABBAR, Commands.TOGGLE_TABBAR, () => {\n            const currentPref = PreferencesManager.get(Preference.PREFERENCES_TAB_BAR);\n            PreferencesManager.set(Preference.PREFERENCES_TAB_BAR, {\n                ...currentPref,\n                showTabBar: !currentPref.showTabBar\n            });\n        });\n    }\n\n    /**\n     * this function sets up mouse wheel scrolling functionality for the tab bars\n     * when the mouse wheel is scrolled up, the tab bar will scroll to the left\n     * when its scrolled down, the tab bar will scroll to the right\n     */\n    function setupTabBarScrolling() {\n        // common  handler for both the tab bars\n        function handleMouseWheel(e) {\n            // get the tab bar element that is being scrolled\n            const $scrolledTabBar = $(this);\n\n            // A negative deltaY means scrolling up so we need to scroll to the left,\n            // positive means scrolling down so we need to scroll to the right\n            // here we calculate the scroll amount (pixels)\n            // and multiply by 2.5 for increasing the scroll amount\n            const scrollAmount = e.originalEvent.deltaY * 2.5;\n\n            // calculate the new scroll position\n            const newScrollLeft = $scrolledTabBar.scrollLeft() + scrollAmount;\n\n            // apply the new scroll position\n            $scrolledTabBar.scrollLeft(newScrollLeft);\n        }\n\n        // attach the wheel event handler to both tab bars\n        $(document).on(\"wheel\", \"#phoenix-tab-bar, #phoenix-tab-bar-2\", handleMouseWheel);\n    }\n\n    AppInit.appReady(function () {\n        _registerCommands();\n\n        // add the toggle tab bar command to the view menu\n        const viewMenu = Menus.getMenu(Menus.AppMenuBar.VIEW_MENU);\n        viewMenu.addMenuItem(Commands.TOGGLE_TABBAR, \"\", Menus.AFTER, Commands.VIEW_HIDE_SIDEBAR);\n\n        PreferencesManager.on(\"change\", Preference.PREFERENCES_TAB_BAR, preferenceChanged);\n        // calling preference changed here itself to check if the tab bar is enabled,\n        // because if it is enabled, preferenceChange automatically calls createTabBar\n        preferenceChanged();\n\n        // this should be called at the last as everything should be setup before registering handlers\n        _registerHandlers();\n\n        // handle when a single tab gets clicked\n        handleTabClick();\n\n        Overflow.init();\n        DragDrop.init($(\"#phoenix-tab-bar\"), $(\"#phoenix-tab-bar-2\"));\n\n        // setup the mouse wheel scrolling\n        setupTabBarScrolling();\n    });\n});\n"],"file":"main.js"}