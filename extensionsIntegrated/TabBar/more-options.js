define(function(require,exports,module){const DropdownButton=require("widgets/DropdownButton"),Strings=require("strings"),CommandManager=require("command/CommandManager"),Commands=require("command/Commands"),FileSystem=require("filesystem/FileSystem"),Global=require("./global"),items=[Strings.CLOSE_TAB,Strings.CLOSE_TABS_TO_THE_LEFT,Strings.CLOSE_TABS_TO_THE_RIGHT,Strings.CLOSE_SAVED_TABS,Strings.CLOSE_ALL_TABS,"---",Strings.CMD_FILE_RENAME,Strings.CMD_FILE_DELETE,Strings.CMD_SHOW_IN_TREE,"---",Strings.REOPEN_CLOSED_FILE];function handleCloseTab(filePath,paneId){if(filePath){const fileObj=FileSystem.getFileForPath(filePath);CommandManager.execute(Commands.FILE_CLOSE,{file:fileObj,paneId:paneId})}}function handleCloseAllTabs(paneId){if(!paneId)return;let workingSet;if((workingSet="first-pane"===paneId?Global.firstPaneWorkingSet:Global.secondPaneWorkingSet)&&0!==workingSet.length)for(let i=workingSet.length-1;i>=0;i--){const fileObj=FileSystem.getFileForPath(workingSet[i].path);CommandManager.execute(Commands.FILE_CLOSE,{file:fileObj,paneId:paneId})}}function handleCloseSavedTabs(paneId){if(!paneId)return;let workingSet;if(!(workingSet="first-pane"===paneId?Global.firstPaneWorkingSet:Global.secondPaneWorkingSet)||0===workingSet.length)return;const unmodifiedEntries=workingSet.filter(entry=>!entry.isDirty);for(let i=unmodifiedEntries.length-1;i>=0;i--){const fileObj=FileSystem.getFileForPath(unmodifiedEntries[i].path);CommandManager.execute(Commands.FILE_CLOSE,{file:fileObj,paneId:paneId})}}function handleCloseTabsToTheLeft(filePath,paneId){if(!filePath)return;let workingSet;if(!(workingSet="first-pane"===paneId?Global.firstPaneWorkingSet:Global.secondPaneWorkingSet))return;const currentIndex=workingSet.findIndex(entry=>entry.path===filePath);if(currentIndex>0){const filesToClose=workingSet.slice(0,currentIndex);for(let i=filesToClose.length-1;i>=0;i--){const fileObj=FileSystem.getFileForPath(filesToClose[i].path);CommandManager.execute(Commands.FILE_CLOSE,{file:fileObj,paneId:paneId})}}}function handleCloseTabsToTheRight(filePath,paneId){if(!filePath)return;let workingSet;if(!(workingSet="first-pane"===paneId?Global.firstPaneWorkingSet:Global.secondPaneWorkingSet))return;const currentIndex=workingSet.findIndex(entry=>entry.path===filePath);if(-1!==currentIndex&&currentIndex<workingSet.length-1){const filesToClose=workingSet.slice(currentIndex+1);for(let i=filesToClose.length-1;i>=0;i--){const fileObj=FileSystem.getFileForPath(filesToClose[i].path);CommandManager.execute(Commands.FILE_CLOSE,{file:fileObj,paneId:paneId})}}}function reopenClosedFile(){CommandManager.execute(Commands.FILE_REOPEN_CLOSED)}function handleFileRename(filePath){if(filePath){CommandManager.execute(Commands.SHOW_SIDEBAR);const fileObj=FileSystem.getFileForPath(filePath);CommandManager.execute(Commands.FILE_RENAME,{file:fileObj})}}function handleFileDelete(filePath){if(filePath){const fileObj=FileSystem.getFileForPath(filePath);CommandManager.execute(Commands.FILE_DELETE,{file:fileObj})}}function handleShowInFileTree(filePath){if(filePath){CommandManager.execute(Commands.SHOW_SIDEBAR);const fileObj=FileSystem.getFileForPath(filePath);CommandManager.execute(Commands.NAVIGATE_SHOW_IN_FILE_TREE,{file:fileObj})}}function showMoreOptionsContextMenu(paneId,x,y,filePath){const dropdown=new DropdownButton.DropdownButton("",items);$("body").append(dropdown.$button),dropdown.$button.css({position:"absolute",left:x+"px",top:y+"px",zIndex:1e3}),dropdown.dropdownExtraClasses="tabbar-context-menu",dropdown.showDropdown(),$(".tabbar-context-menu").css("max-height","300px"),dropdown.on("select",function(e,item){_handleSelection(item,filePath,paneId)}),dropdown.$button.css({display:"none"})}function _handleSelection(item,filePath,paneId){switch(item){case Strings.CLOSE_TAB:handleCloseTab(filePath,paneId);break;case Strings.CLOSE_TABS_TO_THE_LEFT:handleCloseTabsToTheLeft(filePath,paneId);break;case Strings.CLOSE_TABS_TO_THE_RIGHT:handleCloseTabsToTheRight(filePath,paneId);break;case Strings.CLOSE_ALL_TABS:handleCloseAllTabs(paneId);break;case Strings.CLOSE_SAVED_TABS:handleCloseSavedTabs(paneId);break;case Strings.CMD_FILE_RENAME:handleFileRename(filePath);break;case Strings.CMD_FILE_DELETE:handleFileDelete(filePath);break;case Strings.CMD_SHOW_IN_TREE:handleShowInFileTree(filePath);break;case Strings.REOPEN_CLOSED_FILE:reopenClosedFile()}}module.exports={showMoreOptionsContextMenu:showMoreOptionsContextMenu}});
//# sourceMappingURL=more-options.js.map
