{"version":3,"sources":["extensionsIntegrated/CustomSnippets/filterSnippets.js"],"names":["define","require","exports","module","_createFilterString","snippetItem","fields","abbreviation","description","templateText","fileExtension","join","toLowerCase","_calculateMatchPriority","snippet","filterTerms","score","abbr","desc","template","fileExt","forEach","term","indexOf","filterSnippets","snippetList","$filterInput","$","filterText","val","trim","split","matchingSnippets","filter","filterString","every","sort","a","b","scoreA","scoreB"],"mappings":"AAoBAA,OAAO,SAAUC,QAASC,QAASC,QAS/B,SAASC,oBAAoBC,aACzB,MAAMC,OAAS,CACXD,YAAYE,cAAgB,GAC5BF,YAAYG,aAAe,GAC3BH,YAAYI,cAAgB,GAC5BJ,YAAYK,eAAiB,IAEjC,OAAOJ,OAAOK,KAAK,KAAKC,cAa5B,SAASC,wBAAwBC,QAASC,aACtC,IAAIC,MAAQ,EACZ,MAAMC,MAAQH,QAAQP,cAAgB,IAAIK,cACpCM,MAAQJ,QAAQN,aAAe,IAAII,cACnCO,UAAYL,QAAQL,cAAgB,IAAIG,cACxCQ,SAAWN,QAAQJ,eAAiB,IAAIE,cA8B9C,OA5BAG,YAAYM,QAAQ,SAAUC,MAEC,IAAvBL,KAAKM,QAAQD,MACbN,OAAS,IACFC,KAAKM,QAAQD,OAAS,IAC7BN,OAAS,KAIc,IAAvBE,KAAKK,QAAQD,MACbN,OAAS,IACFE,KAAKK,QAAQD,OAAS,IAC7BN,OAAS,IAIkB,IAA3BG,SAASI,QAAQD,MACjBN,OAAS,GACFG,SAASI,QAAQD,OAAS,IACjCN,OAAS,IAITI,QAAQG,QAAQD,OAAS,IACzBN,OAAS,KAIVA,MASX,SAASQ,eAAeC,aACpB,MAAMC,aAAeC,EAAE,0BACjBC,WAAaF,aAAaG,MAAMC,OAAOlB,cAE7C,IAAKgB,WACD,OAAOH,YAGX,MAAMV,YAAca,WAAWG,MAAM,OAG/BC,iBAAmBP,YAAYQ,OAAO,SAAUnB,SAClD,MAAMoB,aAAe9B,oBAAoBU,SAGzC,OAAOC,YAAYoB,MAAM,SAAUb,MAC/B,OAAOY,aAAaX,QAAQD,OAAS,MAK7C,OAAOU,iBAAiBI,KAAK,SAAUC,EAAGC,GACtC,MAAMC,OAAS1B,wBAAwBwB,EAAGtB,aACpCyB,OAAS3B,wBAAwByB,EAAGvB,aAC1C,OAAOyB,OAASD,SAIxBrC,QAAQsB,eAAiBA","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\ndefine(function (require, exports, module) {\n    /**\n     * this function creates a filter string for a snippet containing all the searchable fields\n     * the priority order: abbreviation > description > template text > file extension\n     *\n     * @private\n     * @param {object} snippetItem\n     * @returns {string} - all the searchable fields (in lowercase)\n     */\n    function _createFilterString(snippetItem) {\n        const fields = [\n            snippetItem.abbreviation || \"\",\n            snippetItem.description || \"\",\n            snippetItem.templateText || \"\",\n            snippetItem.fileExtension || \"\"\n        ];\n        return fields.join(\" \").toLowerCase();\n    }\n\n    /**\n     * This function calculates a priority score for search matches\n     * the higher scores means better match and is shown before lower score matches\n     * priority order: abbreviation > description > template text > file extension\n     *\n     * @private\n     * @param {object} snippet\n     * @param {Array} filterTerms\n     * @returns {number} - priority score\n     */\n    function _calculateMatchPriority(snippet, filterTerms) {\n        let score = 0;\n        const abbr = (snippet.abbreviation || \"\").toLowerCase();\n        const desc = (snippet.description || \"\").toLowerCase();\n        const template = (snippet.templateText || \"\").toLowerCase();\n        const fileExt = (snippet.fileExtension || \"\").toLowerCase();\n\n        filterTerms.forEach(function (term) {\n            // abbreviation matching. this has the highest priority\n            if (abbr.indexOf(term) === 0) {\n                score += 1000; // exact start match in abbreviation\n            } else if (abbr.indexOf(term) > -1) {\n                score += 500; // partial match in abbreviation\n            }\n\n            // description matching. this has the second highest priority\n            if (desc.indexOf(term) === 0) {\n                score += 100;\n            } else if (desc.indexOf(term) > -1) {\n                score += 50;\n            }\n\n            // Template text matching. this has the third highest priority\n            if (template.indexOf(term) === 0) {\n                score += 20;\n            } else if (template.indexOf(term) > -1) {\n                score += 10;\n            }\n\n            // File extension matching, lowests priority\n            if (fileExt.indexOf(term) > -1) {\n                score += 5;\n            }\n        });\n\n        return score;\n    }\n\n    /**\n     * This function filters snippets based on the filter input value\n     *\n     * @param {Array} snippetList - array of snippet objects\n     * @returns {Array} - filtered array of snippet objects, sorted by relevance\n     */\n    function filterSnippets(snippetList) {\n        const $filterInput = $(\"#filter-snippets-input\");\n        const filterText = $filterInput.val().trim().toLowerCase();\n\n        if (!filterText) {\n            return snippetList; // return all snippets if no filter\n        }\n\n        const filterTerms = filterText.split(/\\s+/);\n\n        // filter snippets that match all terms\n        const matchingSnippets = snippetList.filter(function (snippet) {\n            const filterString = _createFilterString(snippet);\n\n            // all terms must match (AND logic)\n            return filterTerms.every(function (term) {\n                return filterString.indexOf(term) > -1;\n            });\n        });\n\n        // sort by relevance (higher priority scores first)\n        return matchingSnippets.sort(function (a, b) {\n            const scoreA = _calculateMatchPriority(a, filterTerms);\n            const scoreB = _calculateMatchPriority(b, filterTerms);\n            return scoreB - scoreA; // in descending order (highest score will be at first)\n        });\n    }\n\n    exports.filterSnippets = filterSnippets;\n});\n"],"file":"filterSnippets.js"}