{"version":3,"sources":["extensions/default/HealthData/HealthDataNotification.js"],"names":["define","require","exports","module","PreferencesManager","brackets","getModule","ExtensionInterface","HealthDataPreview","HealthDataPopup","NEW_PROJECT_EXTENSION_INTERFACE","POPUP_FIRST_LAUNCH_SHOW_DELAY","newProjectExtension","handleHealthDataStatistics","previewHealthData","waitAndGetExtensionInterface","then","interfaceObj","on","EVENT_NEW_PROJECT_DIALOGUE_CLOSED","setTimeout","_showFirstLaunchPopup","popupShownInThisSession","off","window","testEnvironment","alreadyShown","getViewState","prefs","getExtensionPrefs","get","showFirstLaunchTooltip","done","setViewState"],"mappings":"AA0BAA,OAAO,SAAUC,QAASC,QAASC,QAE/B,IAAIC,mBAA+BC,SAASC,UAAU,kCAClDC,mBAA+BF,SAASC,UAAU,4BAClDE,kBAA+BP,QAAQ,qBACvCQ,gBAA+BR,QAAQ,mBAE3C,MAAMS,gCAAkC,0BAKpCC,8BAAgC,IAEpC,IAAIC,oBASJ,SAASC,6BACLL,kBAAkBM,oBATtBP,mBAAmBQ,6BARqB,2BASnCC,KAAKC,eACFL,oBAAsBK,aACtBA,aAAaC,GAAGD,aAAaE,kCAAmC,KAC5DC,WAAWC,sBAPa,SAepC,IAAIC,yBAA0B,EAC9B,SAASD,wBAGL,IAAGC,0BAGHA,yBAA0B,EAC1BV,oBAAoBW,IAAIX,oBAAoBO,kCAAmCE,wBAC3EG,OAAOC,iBAAgB,CACvB,MAAMC,aAAetB,mBAAmBuB,aAAa,+BAC/CC,MAAQxB,mBAAmByB,kBAAkB,eAC9CH,cAAgBE,MAAME,IAAI,uBAC3BrB,gBAAgBsB,yBACXC,KAAK,WACF5B,mBAAmB6B,aAAa,+BAA+B,MAMnF/B,QAAQW,2BAAmCA","sourcesContent":["/*\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2015 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n *\n */\n\n/*global Phoenix*/\n\ndefine(function (require, exports, module) {\n\n    var PreferencesManager           = brackets.getModule(\"preferences/PreferencesManager\"),\n        ExtensionInterface           = brackets.getModule(\"utils/ExtensionInterface\"),\n        HealthDataPreview            = require(\"HealthDataPreview\"),\n        HealthDataPopup              = require(\"HealthDataPopup\");\n\n    const NEW_PROJECT_EXTENSION_INTERFACE = \"Extn.Phoenix.newProject\",\n        // Since we don't have any user accounts or trackable ID to uniquely identify a user on first launch,\n        // we should be ok GDPR wise to delay showing the health data popup. But it was found later to be annoying\n        // and a workflow distraction. So we show the health data popup almost immediately so that the user can\n        // close all the popups in on go.\n        POPUP_FIRST_LAUNCH_SHOW_DELAY = 5000;\n\n    let newProjectExtension;\n    ExtensionInterface.waitAndGetExtensionInterface(NEW_PROJECT_EXTENSION_INTERFACE)\n        .then(interfaceObj => {\n            newProjectExtension = interfaceObj;\n            interfaceObj.on(interfaceObj.EVENT_NEW_PROJECT_DIALOGUE_CLOSED, ()=>{\n                setTimeout(_showFirstLaunchPopup, POPUP_FIRST_LAUNCH_SHOW_DELAY);\n            });\n        });\n\n    function handleHealthDataStatistics() {\n        HealthDataPreview.previewHealthData();\n    }\n\n    let popupShownInThisSession = false;\n    function _showFirstLaunchPopup() {\n        // call this only after newProjectExtn interface is available\n        // Check whether the notification dialog should be shown. It will be shown only one time.\n        if(popupShownInThisSession){\n            return;\n        }\n        popupShownInThisSession = true;\n        newProjectExtension.off(newProjectExtension.EVENT_NEW_PROJECT_DIALOGUE_CLOSED, _showFirstLaunchPopup);\n        if(!window.testEnvironment){\n            const alreadyShown = PreferencesManager.getViewState(\"healthDataNotificationShown\");\n            const prefs = PreferencesManager.getExtensionPrefs(\"healthData\");\n            if (!alreadyShown && prefs.get(\"healthDataTracking\")) {\n                HealthDataPopup.showFirstLaunchTooltip()\n                    .done(function () {\n                        PreferencesManager.setViewState(\"healthDataNotificationShown\", true);\n                    });\n            }\n        }\n    }\n\n    exports.handleHealthDataStatistics       = handleHealthDataStatistics;\n});\n"],"file":"HealthDataNotification.js"}