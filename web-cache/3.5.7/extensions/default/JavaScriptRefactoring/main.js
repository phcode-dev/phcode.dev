define(function(require,exports,module){var AppInit=brackets.getModule("utils/AppInit"),PreferencesManager=brackets.getModule("preferences/PreferencesManager"),Strings=brackets.getModule("strings"),RenameIdentifier=require("RenameIdentifier"),ExtractToVariable=require("ExtractToVariable"),ExtractToFunction=require("ExtractToFunction"),WrapSelection=require("WrapSelection"),CommandManager=brackets.getModule("command/CommandManager"),Menus=brackets.getModule("command/Menus"),Metrics=brackets.getModule("utils/Metrics"),_=brackets.getModule("thirdparty/lodash"),EditorManager=brackets.getModule("editor/EditorManager");require("HighLightReferences");var jsRefactoringEnabled=!0,KeyboardPrefs=JSON.parse(require("text!keyboard.json")),EXTRACTTO_VARIABLE="refactoring.extractToVariable",EXTRACTTO_FUNCTION="refactoring.extractToFunction",REFACTOR_RENAME="refactoring.renamereference",REFACTORWRAPINTRYCATCH="refactoring.wrapintrycatch",REFACTORWRAPINCONDITION="refactoring.wrapincondition",REFACTORCONVERTTOARROWFN="refactoring.converttoarrowfunction",REFACTORCREATEGETSET="refactoring.creategettersandsetters";function _isRefactoringEnabled(){return!1!==PreferencesManager.get("refactoring.JSRefactoring")}function _handleRefactor(functionName){var eventName,eventType="";switch(functionName){case REFACTOR_RENAME:eventName=REFACTOR_RENAME,eventType="rename",RenameIdentifier.handleRename();break;case EXTRACTTO_VARIABLE:eventName=EXTRACTTO_VARIABLE,eventType="extractToVariable",ExtractToVariable.handleExtractToVariable();break;case EXTRACTTO_FUNCTION:eventName=EXTRACTTO_FUNCTION,eventType="extractToFunction",ExtractToFunction.handleExtractToFunction();break;case REFACTORWRAPINTRYCATCH:eventName=REFACTORWRAPINTRYCATCH,eventType="wrapInTryCatch",WrapSelection.wrapInTryCatch();break;case REFACTORWRAPINCONDITION:eventName=REFACTORWRAPINCONDITION,eventType="wrapInCondition",WrapSelection.wrapInCondition();break;case REFACTORCONVERTTOARROWFN:eventName=REFACTORCONVERTTOARROWFN,eventType="convertToFunction",WrapSelection.convertToArrowFunction();break;case REFACTORCREATEGETSET:eventName=REFACTORCREATEGETSET,eventType="createGetterSetter",WrapSelection.createGettersAndSetters()}if(eventName){var editor=EditorManager.getActiveEditor();if(!editor||"javascript"!==editor.getModeForSelection())return;Metrics.countEvent(Metrics.EVENT_TYPE.CODE_HINTS,"jsRefactor",eventType)}}PreferencesManager.definePreference("refactoring.JSRefactoring","boolean",!0,{description:Strings.DESCRIPTION_CODE_REFACTORING}),PreferencesManager.on("change","refactoring.JSRefactoring",function(){jsRefactoringEnabled=_isRefactoringEnabled()}),AppInit.appReady(function(){if(jsRefactoringEnabled){var subMenu=Menus.getContextMenu(Menus.ContextMenuIds.EDITOR_MENU).addSubMenu(Strings.CMD_REFACTOR,"refactor-submenu"),menuLocation=Menus.AppMenuBar.EDIT_MENU;Menus.getMenu(menuLocation).addMenuDivider(),CommandManager.register(Strings.CMD_REFACTORING_RENAME,REFACTOR_RENAME,_.partial(_handleRefactor,REFACTOR_RENAME)),subMenu.addMenuItem(REFACTOR_RENAME),Menus.getMenu(menuLocation).addMenuItem(REFACTOR_RENAME,KeyboardPrefs.renameIdentifier),CommandManager.register(Strings.CMD_EXTRACTTO_VARIABLE,EXTRACTTO_VARIABLE,_.partial(_handleRefactor,EXTRACTTO_VARIABLE)),subMenu.addMenuItem(EXTRACTTO_VARIABLE),Menus.getMenu(menuLocation).addMenuItem(EXTRACTTO_VARIABLE,KeyboardPrefs.extractToVariable),CommandManager.register(Strings.CMD_EXTRACTTO_FUNCTION,EXTRACTTO_FUNCTION,_.partial(_handleRefactor,EXTRACTTO_FUNCTION)),subMenu.addMenuItem(EXTRACTTO_FUNCTION),Menus.getMenu(menuLocation).addMenuItem(EXTRACTTO_FUNCTION,KeyboardPrefs.extractToFunction),CommandManager.register(Strings.CMD_REFACTORING_TRY_CATCH,REFACTORWRAPINTRYCATCH,_.partial(_handleRefactor,REFACTORWRAPINTRYCATCH)),subMenu.addMenuItem(REFACTORWRAPINTRYCATCH),Menus.getMenu(menuLocation).addMenuItem(REFACTORWRAPINTRYCATCH),CommandManager.register(Strings.CMD_REFACTORING_CONDITION,REFACTORWRAPINCONDITION,_.partial(_handleRefactor,REFACTORWRAPINCONDITION)),subMenu.addMenuItem(REFACTORWRAPINCONDITION),Menus.getMenu(menuLocation).addMenuItem(REFACTORWRAPINCONDITION),CommandManager.register(Strings.CMD_REFACTORING_ARROW_FUNCTION,REFACTORCONVERTTOARROWFN,_.partial(_handleRefactor,REFACTORCONVERTTOARROWFN)),subMenu.addMenuItem(REFACTORCONVERTTOARROWFN),Menus.getMenu(menuLocation).addMenuItem(REFACTORCONVERTTOARROWFN),CommandManager.register(Strings.CMD_REFACTORING_GETTERS_SETTERS,REFACTORCREATEGETSET,_.partial(_handleRefactor,REFACTORCREATEGETSET)),subMenu.addMenuItem(REFACTORCREATEGETSET),Menus.getMenu(menuLocation).addMenuItem(REFACTORCREATEGETSET)}})});
//# sourceMappingURL=main.js.map
