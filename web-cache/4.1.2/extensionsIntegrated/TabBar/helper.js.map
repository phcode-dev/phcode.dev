{"version":3,"sources":["extensionsIntegrated/TabBar/helper.js"],"names":["define","require","exports","module","WorkspaceManager","DocumentManager","ViewUtils","WorkingSetView","FileUtils","_showTabBar","$tabBar","$overflowButton","show","recomputeLayout","_hideTabBar","hide","_getRequiredDataFromEntry","entry","path","fullPath","name","isFile","isDirty","isPinned","displayName","_isFileModified","file","doc","getOpenDocumentForPath","_getFileIcon","fileData","$link","$","html","getFileEntryDisplay","useIconProviders","children","first","_handleDuplicateFileNames","workingSet","fileNameCount","forEach","parentDir","getDirectoryPath","dirName","split","parentDirName","length"],"mappings":"AAqBAA,OAAO,SAAUC,QAASC,QAASC,QAE/B,MAAMC,iBAAmBH,QAAQ,yBAC3BI,gBAAkBJ,QAAQ,4BAC1BK,UAAYL,QAAQ,mBACpBM,eAAiBN,QAAQ,0BACzBO,UAAYP,QAAQ,kBAU1B,SAASQ,YAAYC,QAASC,iBACtBD,UACAA,QAAQE,OACLD,iBACCA,gBAAgBC,OAIpBR,iBAAiBS,iBAAgB,IAYzC,SAASC,YAAYJ,QAASC,iBACtBD,UACAA,QAAQK,OACLJ,iBACCA,gBAAgBI,OAEpBX,iBAAiBS,iBAAgB,IAYzC,SAASG,0BAA0BC,OAC/B,MAAO,CACHC,KAAMD,MAAME,SACZC,KAAMH,MAAMG,KACZC,OAAQJ,MAAMI,OACdC,QAASL,MAAMK,QACfC,SAAUN,MAAMM,SAChBC,YAAaP,MAAMG,MAU3B,SAASK,gBAAgBC,MACrB,MAAMC,IAAMtB,gBAAgBuB,uBAAuBF,KAAKP,UACxD,OAAOQ,KAAOA,IAAIL,QAUtB,SAASO,aAAaC,UAClB,MAAMC,MAAQC,EAAE,oCAAoCC,KAChD3B,UAAU4B,oBAAoB,CAAEd,KAAMU,SAASV,QAOnD,OALAb,eAAe4B,iBAAiB,CAC5BhB,SAAUW,SAASZ,KACnBE,KAAMU,SAASV,KACfC,QAAQ,GACTU,OACIA,MAAMK,WAAWC,QAU5B,SAASC,0BAA0BC,YAE/B,MAAMC,cAAgB,GAGtBD,WAAWE,QAAQxB,QACVuB,cAAcvB,MAAMG,MAGrBoB,cAAcvB,MAAMG,QAFpBoB,cAAcvB,MAAMG,MAAQ,IAOpCmB,WAAWE,QAAQxB,QACf,GAAIuB,cAAcvB,MAAMG,MAAQ,EAAG,CAE/B,MAAMF,KAAOD,MAAMC,KACbwB,UAAYlC,UAAUmC,iBAAiBzB,MAGvC0B,QAAUF,UAAUG,MAAM,KAE1BC,cAAgBF,QAAQA,QAAQG,OAAS,IAAM,GAGrD9B,MAAMO,YAAcsB,cAAgB,IAAM7B,MAAMG,UAEhDH,MAAMO,YAAcP,MAAMG,OAMtCjB,OAAOD,QAAU,CACbO,YAAAA,YACAK,YAAAA,YACAE,0BAAAA,0BACAS,gBAAAA,gBACAI,aAAAA,aACAS,0BAAAA","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n/* This file contains helper functions for the tab bar */\ndefine(function (require, exports, module) {\n\n    const WorkspaceManager = require(\"view/WorkspaceManager\");\n    const DocumentManager = require(\"document/DocumentManager\");\n    const ViewUtils = require(\"utils/ViewUtils\");\n    const WorkingSetView = require(\"project/WorkingSetView\");\n    const FileUtils = require(\"file/FileUtils\");\n\n\n    /**\n     * Shows the tab bar, when it is hidden.\n     * Its only shown when tab bar is enabled and there is atleast one working file\n     *\n     * @param {$.Element} $tabBar - The tab bar element\n     * @param {$.Element} $overflowButton - The overflow button element\n     */\n    function _showTabBar($tabBar, $overflowButton) {\n        if ($tabBar) {\n            $tabBar.show();\n            if($overflowButton) {\n                $overflowButton.show();\n            }\n            // when we add/remove something from the editor, the editor shifts up/down which leads to blank space\n            // so we need to recompute the layout to make sure things are in the right place\n            WorkspaceManager.recomputeLayout(true);\n        }\n    }\n\n    /**\n     * Hides the tab bar.\n     * Its hidden when tab bar feature is disabled or there are no working files\n     * both the tab bar and the overflow button are to be hidden to hide the tab bar container\n     *\n     * @param {$.Element} $tabBar - The tab bar element\n     * @param {$.Element} $overflowButton - The overflow button element\n     */\n    function _hideTabBar($tabBar, $overflowButton) {\n        if ($tabBar) {\n            $tabBar.hide();\n            if($overflowButton) {\n                $overflowButton.hide();\n            }\n            WorkspaceManager.recomputeLayout(true);\n        }\n    }\n\n\n    /**\n     * Entry is a single object that comes from MainViewManager's getWorkingSet\n     * We extract the required data from the entry\n     *\n     * @param {Object} entry - A single file entry from MainViewManager.getWorkingSet()\n     * @returns {Object} - the required data\n     */\n    function _getRequiredDataFromEntry(entry) {\n        return {\n            path: entry.fullPath,\n            name: entry.name,\n            isFile: entry.isFile,\n            isDirty: entry.isDirty,\n            isPinned: entry.isPinned,\n            displayName: entry.name // Initialize displayName with name, it will be updated if duplicates are found\n        };\n    }\n\n    /**\n     * checks whether a file is dirty or not\n     *\n     * @param {File} file - the file to check\n     * @return {boolean} true if the file is dirty, false otherwise\n     */\n    function _isFileModified(file) {\n        const doc = DocumentManager.getOpenDocumentForPath(file.fullPath);\n        return doc && doc.isDirty;\n    }\n\n\n    /**\n     * Returns a jQuery object containing the file icon for a given file\n     *\n     * @param {Object} fileData - The file data object\n     * @returns {jQuery} jQuery object containing the file icon\n     */\n    function _getFileIcon(fileData) {\n        const $link = $(\"<a href='#' class='mroitem'></a>\").html(\n            ViewUtils.getFileEntryDisplay({ name: fileData.name })\n        );\n        WorkingSetView.useIconProviders({\n            fullPath: fileData.path,\n            name: fileData.name,\n            isFile: true\n        }, $link);\n        return $link.children().first();\n    }\n\n\n    /**\n     * Checks for duplicate file names in the working set and updates displayName accordingly\n     * if duplicate file names are found, we update the displayName to include the directory\n     *\n     * @param {Array} workingSet - The working set to check for duplicates\n     */\n    function _handleDuplicateFileNames(workingSet) {\n        // Create a map to track filename occurrences\n        const fileNameCount = {};\n\n        // First, count occurrences of each filename\n        workingSet.forEach(entry => {\n            if (!fileNameCount[entry.name]) {\n                fileNameCount[entry.name] = 1;\n            } else {\n                fileNameCount[entry.name]++;\n            }\n        });\n\n        // Then, update the displayName for files with duplicate names\n        workingSet.forEach(entry => {\n            if (fileNameCount[entry.name] > 1) {\n                // Get the parent directory name\n                const path = entry.path;\n                const parentDir = FileUtils.getDirectoryPath(path);\n\n                // Get just the directory name, not the full path\n                const dirName = parentDir.split(\"/\");\n                // Get the parent directory name (second-to-last part of the path)\n                const parentDirName = dirName[dirName.length - 2] || \"\";\n\n                // Set the display name to include the parent directory\n                entry.displayName = parentDirName + \"/\" + entry.name;\n            } else {\n                entry.displayName = entry.name;\n            }\n        });\n    }\n\n\n    module.exports = {\n        _showTabBar,\n        _hideTabBar,\n        _getRequiredDataFromEntry,\n        _isFileModified,\n        _getFileIcon,\n        _handleDuplicateFileNames\n    };\n});\n"],"file":"helper.js"}