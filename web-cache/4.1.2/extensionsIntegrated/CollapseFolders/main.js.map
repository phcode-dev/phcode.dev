{"version":3,"sources":["extensionsIntegrated/CollapseFolders/main.js"],"names":["define","require","exports","module","AppInit","ProjectManager","Strings","handleCollapseBtnClick","openNodes","_actionCreator","model","getOpenNodes","length","i","forEach","folderPath","setDirectoryOpen","error","console","createCollapseButton","$projectFilesHeader","$","$collapseBtn","COLLAPSE_ALL_FOLDERS","on","append","appReady"],"mappings":"AAuBAA,OAAO,SAAUC,QAASC,QAASC,QAC/B,MAAMC,QAAUH,QAAQ,iBAClBI,eAAiBJ,QAAQ,0BACzBK,QAAUL,QAAQ,WAKxB,SAASM,yBAGL,MAAMC,UAAYH,eAAeI,eAAeC,MAAMC,eACtD,GAAKH,WAAkC,IAArBA,UAAUI,OAM5B,IAAK,IAAIC,EAAIL,UAAUI,OAAS,EAAGC,GAAK,EAAGA,IAEvCL,UAAUK,GAAGC,QAAQ,SAAUC,YAC3B,IAEIV,eAAeI,eAAeO,iBAAiBD,YAAY,GAC7D,MAAOE,OACLC,QAAQD,MAAM,0BAA2BF,WAAYE,UAUrE,SAASE,uBACL,MAAMC,oBAAsBC,EAAE,yBAE9B,GAAmC,IAA/BD,oBAAoBR,OACpB,OAIJ,MAAMU,aAAeD,2EACyCf,QAAQiB,4OAMtED,aAAaE,GAAG,QAASjB,wBACzBa,oBAAoBK,OAAOH,cAG/BlB,QAAQsB,SAAS,WACbP","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n/* Displays a Collapse button in the sidebar area */\n/* when the button gets clicked, it closes all the directories recursively that are opened */\n/* Styling for the button is done in `../../styles/Extn-CollapseFolders.less` */\ndefine(function (require, exports, module) {\n    const AppInit = require(\"utils/AppInit\");\n    const ProjectManager = require(\"project/ProjectManager\");\n    const Strings = require(\"strings\");\n\n    /**\n     * This is the main function that handles the closing of all the directories\n     */\n    function handleCollapseBtnClick() {\n        // this will give us an array of array's\n        // the root level directories will be at index 0, its next level will be at index 1 and so on\n        const openNodes = ProjectManager._actionCreator.model.getOpenNodes();\n        if (!openNodes || openNodes.length === 0) {\n            return;\n        }\n\n        // traversing from the back because the deepest nested directories should be closed first\n        // Note: this is an array of all the directories at the deepest level\n        for (let i = openNodes.length - 1; i >= 0; i--) {\n            // close all the directories\n            openNodes[i].forEach(function (folderPath) {\n                try {\n                    // to close each dir\n                    ProjectManager._actionCreator.setDirectoryOpen(folderPath, false);\n                } catch (error) {\n                    console.error(\"Failed to close folder:\", folderPath, error);\n                }\n            });\n        }\n    }\n\n    /**\n     * This function is responsible to create the 'Collapse All' button\n     * and append it to the sidebar area on the project-files-header\n     */\n    function createCollapseButton() {\n        const $projectFilesHeader = $(\"#project-files-header\");\n        // make sure that we were able to get the project-files-header DOM element\n        if ($projectFilesHeader.length === 0) {\n            return;\n        }\n\n        // create the collapse btn\n        const $collapseBtn = $(`\n            <div id=\"collapse-folders\" class=\"btn-alt-quiet\" title=\"${Strings.COLLAPSE_ALL_FOLDERS}\">\n                <i class=\"fa-solid fa-chevron-down collapse-icon\" aria-hidden=\"true\"></i>\n                <i class=\"fa-solid fa-chevron-up collapse-icon\" aria-hidden=\"true\"></i>\n            </div>\n        `);\n\n        $collapseBtn.on(\"click\", handleCollapseBtnClick);\n        $projectFilesHeader.append($collapseBtn); // append the btn to the project-files-header\n    }\n\n    AppInit.appReady(function () {\n        createCollapseButton();\n    });\n});\n"],"file":"main.js"}