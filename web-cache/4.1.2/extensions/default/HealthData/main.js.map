{"version":3,"sources":["extensions/default/HealthData/extension-min.js"],"names":["define","require","exports","module","AppInit","brackets","getModule","Menus","CommandManager","Strings","Commands","HealthDataNotification","HealthDataManager","HealthDataPopup","menu","getMenu","AppMenuBar","HELP_MENU","healthDataCmdId","handleHealthDataStatistics","addCommand","register","CMD_HEALTH_DATA_STATISTICS","addMenuItem","AFTER","HELP_GET_INVOLVED","addMenuDivider","initTest","test","HealthDataPreview","appReady","PreferencesManager","Metrics","SendToAnalytics","prefs","getExtensionPrefs","ONE_SECOND","TEN_SECOND","ONE_MINUTE","MAX_DAYS_TO_KEEP_COUNTS","USAGE_COUNTS_KEY","isPowerUser","usageData","getViewState","dateKeys","Object","keys","dateBefore14Days","Date","totalUsageMinutes","totalUsageDays","setUTCDate","getUTCDate","dateKey","date","healthDataDisabled","_pruneUsageData","dateBefore60Days","setDate","getDate","length","setViewState","_trackUsageInfo","setInterval","dateNow","today","toISOString","split","definePreference","description","DESCRIPTION_HEALTH_DATA_TRACKING","on","get","setDisabled","logger","loggingOptions","init","isPowerUserFn","Phoenix","healthTrackingDisabled","countEvent","PLATFORM","sendPlatformMetrics","sendThemesMetrics","setTimeout","sendStartupPerformanceMetrics","previewHealthData","_showFirstLaunchPopup","window","testEnvironment","alreadyShown","showFirstLaunchTooltip","done","NotificationUI","deferred","$","Deferred","createToastFromTemplate","HEALTH_FIRST_POPUP_TITLE","HEALTH_DATA_NOTIFICATION_MESSAGE","resolve","promise","_","Mustache","Dialogs","ExtensionUtils","HealthDataPreviewDialog","_buildPreviewData","content","auditData","getLoggedDataForAudit","sortedData","Map","entries","sort","displayData","key","value","valueString","count","eventType","AUDIT_TYPE_COUNT","push","sum","AUDIT_TYPE_VALUE","JSON","stringify","escape","replace","hdPref","template","render","$template","addLinkTooltips","showModalDialogUsingTemplate","id","newHDPref","find","is","set","clearAuditData","loadStyleSheet","PerfUtils","NodeUtils","themesPref","BugsnagPerformance","EVENT_TYPE","PERFORMANCE","STORAGE","_emitDeviceTypeMetrics","browser","isDeskTop","isMobile","isTablet","_emitMobileMetricsIfPresent","platform","mobile","isIos","isWindows","isAndroid","_emitBrowserMetrics","desktop","isChrome","isChromeBased","isEdgeChromium","isFirefox","isOpera","isOperaChromium","async","_sendStorageMetrics","navigator","storage","estimate","quota","percentageUsed","Math","round","usage","usedMB","console","log","valueEvent","_getPlatformInfo","OS","userAgent","appVersion","app","language","getLocale","metadata","version","isNativeApp","getLinuxOSFlavorName","then","flavor","bugsnagPerformanceInited","_initBugsnagPerformance","start","apiKey","AppConfig","releaseStage","__TAURI__","config","bugsnagEnv","autoInstrumentRouteChanges","autoInstrumentNetworkRequests","autoInstrumentFullPageLoads","_bugsnagPerformance","valueMs","isDisabled","isTestWindow","activityStartTime","activityEndTime","getTime","startSpan","startTime","end","healthReport","getHealthReport","labelAppStart","firstBoot","Number","PhStore","_storageBootstrapTime","_tauriBootVars","bootstrapTime","nodeSetupDonePromise","PhNodeEngine","_nodeLoadTime","catch","_err","_getCurrentTheme","THEMES"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2015 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n *\n */\n\ndefine(function (require, exports, module) {\n\n    var AppInit                 = brackets.getModule(\"utils/AppInit\"),\n        Menus                   = brackets.getModule(\"command/Menus\"),\n        CommandManager          = brackets.getModule(\"command/CommandManager\"),\n        Strings                 = brackets.getModule(\"strings\"),\n        Commands                = brackets.getModule(\"command/Commands\"),\n        HealthDataNotification  = require(\"HealthDataNotification\"),  // self-initializes to show first-launch notification\n        HealthDataManager       = require(\"HealthDataManager\"),  // self-initializes timer to send data\n        HealthDataPopup         = require(\"HealthDataPopup\");\n\n    var menu            = Menus.getMenu(Menus.AppMenuBar.HELP_MENU),\n        healthDataCmdId = \"healthData.healthDataStatistics\";\n\n    // Handles the command execution for Health Data menu item\n    function handleHealthDataStatistics() {\n        HealthDataNotification.handleHealthDataStatistics();\n    }\n\n    // Register the command and add the menu item for the Health Data Statistics\n    function addCommand() {\n        CommandManager.register(Strings.CMD_HEALTH_DATA_STATISTICS, healthDataCmdId, handleHealthDataStatistics);\n\n        menu.addMenuItem(healthDataCmdId, \"\", Menus.AFTER, Commands.HELP_GET_INVOLVED);\n        menu.addMenuDivider(Menus.AFTER, Commands.HELP_GET_INVOLVED);\n    }\n\n    function initTest() {\n        brackets.test.HealthDataPreview      = require(\"HealthDataPreview\");\n        brackets.test.HealthDataManager      = HealthDataManager;\n        brackets.test.HealthDataNotification = HealthDataNotification;\n        brackets.test.HealthDataPopup        = HealthDataPopup;\n    }\n\n    AppInit.appReady(function () {\n        initTest();\n    });\n\n    addCommand();\n\n});\n\n/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2015 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n *\n */\n\n/*global logger*/\ndefine(\"HealthDataManager\", function (require, exports, module) {\n    var AppInit             = brackets.getModule(\"utils/AppInit\"),\n        PreferencesManager  = brackets.getModule(\"preferences/PreferencesManager\"),\n        Strings             = brackets.getModule(\"strings\"),\n        Metrics             = brackets.getModule(\"utils/Metrics\"),\n        SendToAnalytics     = require(\"SendToAnalytics\"),\n        prefs               = PreferencesManager.getExtensionPrefs(\"healthData\"),\n        ONE_SECOND          = 1000,\n        TEN_SECOND          = 10 * ONE_SECOND,\n        ONE_MINUTE          = 60000,\n        MAX_DAYS_TO_KEEP_COUNTS = 60,\n        USAGE_COUNTS_KEY    = \"healthDataUsage\";\n\n    /**\n     * A power user is someone who has used Phoenix at least 3 days or 8 hours in the last two weeks\n     * @returns {boolean}\n     */\n    function isPowerUser() {\n        let usageData = PreferencesManager.getViewState(USAGE_COUNTS_KEY) || {},\n            dateKeys = Object.keys(usageData),\n            dateBefore14Days = new Date(),\n            totalUsageMinutes = 0,\n            totalUsageDays = 0;\n        dateBefore14Days.setUTCDate(dateBefore14Days.getUTCDate()-14);\n        for(let dateKey of dateKeys){\n            let date = new Date(dateKey);\n            if(date >= dateBefore14Days) {\n                totalUsageDays ++;\n                totalUsageMinutes = totalUsageMinutes + usageData[dateKey];\n            }\n        }\n        return totalUsageDays >= 3 || (totalUsageMinutes/60) >= 8;\n    }\n\n    let healthDataDisabled;\n\n    prefs.definePreference(\"healthDataTracking\", \"boolean\", true, {\n        description: Strings.DESCRIPTION_HEALTH_DATA_TRACKING\n    });\n\n    prefs.on(\"change\", \"healthDataTracking\", function () {\n        healthDataDisabled = !prefs.get(\"healthDataTracking\");\n        Metrics.setDisabled(healthDataDisabled);\n        logger.loggingOptions.healthDataDisabled = healthDataDisabled;\n    });\n\n    // we delete all usage counts greater than MAX_DAYS_TO_KEEP_COUNTS days\n    function _pruneUsageData() {\n        let usageData = PreferencesManager.getViewState(USAGE_COUNTS_KEY) || {},\n            dateKeys = Object.keys(usageData),\n            dateBefore60Days = new Date();\n        dateBefore60Days.setDate(dateBefore60Days.getDate() - MAX_DAYS_TO_KEEP_COUNTS);\n        if(dateKeys.length > MAX_DAYS_TO_KEEP_COUNTS) {\n            for(let dateKey of dateKeys){\n                let date = new Date(dateKey);\n                if(date < dateBefore60Days) {\n                    delete usageData[dateKey];\n                }\n            }\n        }\n        // low priority, we do not want to save this right now\n        PreferencesManager.setViewState(USAGE_COUNTS_KEY, usageData);\n    }\n\n    function _trackUsageInfo() {\n        _pruneUsageData();\n        setInterval(()=>{\n            if(healthDataDisabled){\n                return;\n            }\n            let usageData = PreferencesManager.getViewState(USAGE_COUNTS_KEY) || {};\n            let dateNow = new Date();\n            let today = dateNow.toISOString().split('T')[0]; // yyyy-mm-dd format\n            usageData[today] = (usageData[today] || 0) + 1;\n            // low priority, we do not want to save this right now\n            PreferencesManager.setViewState(USAGE_COUNTS_KEY, usageData);\n        }, ONE_MINUTE);\n    }\n\n    AppInit.appReady(function () {\n        Metrics.init({\n            isPowerUserFn: isPowerUser\n        });\n        healthDataDisabled = !prefs.get(\"healthDataTracking\");\n        if (healthDataDisabled && !Phoenix.healthTrackingDisabled) {\n            // Phoenix.healthTrackingDisabled is initialized at boot using localStorage.\n            // However, there's a theoretical edge case where the browser may have cleared\n            // localStorage, causing a mismatch between the boot-time flag and the actual\n            // persisted user preference.\n            //\n            // This means we might unintentionally log some metrics during the short window\n            // before the real preference is loaded and applied.\n            //\n            // To track this discrepancy, we emit a one-time metric just before disabling tracking,\n            // so we’re aware of this inconsistency and can address it if needed.\n            Metrics.countEvent(Metrics.PLATFORM, \"metricBoot\", \"disableErr\");\n        }\n        Metrics.setDisabled(healthDataDisabled);\n        SendToAnalytics.sendPlatformMetrics();\n        SendToAnalytics.sendThemesMetrics();\n        _trackUsageInfo();\n        setTimeout(SendToAnalytics.sendStartupPerformanceMetrics, TEN_SECOND);\n    });\n});\n\n// SPDX-License-Identifier: AGPL-3.0-only\n// Copyright (c) 2021 - present core.ai. All rights reserved.\n\n/*global*/\n\ndefine(\"HealthDataNotification\", function (require, exports, module) {\n\n    const PreferencesManager           = brackets.getModule(\"preferences/PreferencesManager\"),\n        HealthDataPreview            = require(\"HealthDataPreview\"),\n        HealthDataPopup              = require(\"HealthDataPopup\");\n\n    // Since we don't have any user accounts or trackable ID to uniquely identify a user on first launch,\n    // we should be ok GDPR wise to delay showing the health data popup. But it was found later to be annoying\n    // and a workflow distraction. So we show the health data popup almost immediately so that the user can\n    // close all the popups in on go.\n\n    _showFirstLaunchPopup();\n\n    function handleHealthDataStatistics() {\n        HealthDataPreview.previewHealthData();\n    }\n\n    function _showFirstLaunchPopup() {\n        if(!window.testEnvironment){\n            const alreadyShown = PreferencesManager.getViewState(\"healthDataNotificationShown\");\n            const prefs = PreferencesManager.getExtensionPrefs(\"healthData\");\n            if (!alreadyShown && prefs.get(\"healthDataTracking\")) {\n                HealthDataPopup.showFirstLaunchTooltip()\n                    .done(function () {\n                        PreferencesManager.setViewState(\"healthDataNotificationShown\", true);\n                    });\n            }\n        }\n    }\n\n    exports.handleHealthDataStatistics       = handleHealthDataStatistics;\n});\n\n/*\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2015 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n *\n */\n\ndefine(\"HealthDataPopup\", function (require, exports, module) {\n\n    // Load dependent modules\n    const NotificationUI = brackets.getModule(\"widgets/NotificationUI\"),\n        Strings = brackets.getModule(\"strings\");\n\n    function showFirstLaunchTooltip() {\n        const deferred = new $.Deferred();\n        NotificationUI.createToastFromTemplate(Strings.HEALTH_FIRST_POPUP_TITLE,\n            `<div id=\"healthdata-firstlaunch-popup\">${Strings.HEALTH_DATA_NOTIFICATION_MESSAGE}</div>`).done(deferred.resolve);\n        return deferred.promise();\n    }\n\n    exports.showFirstLaunchTooltip          = showFirstLaunchTooltip;\n});\n\n/*\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2015 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n *\n */\n\ndefine(\"HealthDataPreview\", function (require, exports, module) {\n\n    var _                       = brackets.getModule(\"thirdparty/lodash\"),\n        Mustache                = brackets.getModule(\"thirdparty/mustache/mustache\"),\n        PreferencesManager      = brackets.getModule(\"preferences/PreferencesManager\"),\n        Strings                 = brackets.getModule(\"strings\"),\n        Dialogs                 = brackets.getModule(\"widgets/Dialogs\"),\n        ExtensionUtils          = brackets.getModule(\"utils/ExtensionUtils\"),\n        Metrics                 = brackets.getModule(\"utils/Metrics\"),\n        HealthDataPreviewDialog = `<div class=\"health-data-preview modal\">\n    <div class=\"modal-header\">\n        <h1 class=\"dialog-title\">{{Strings.HEALTH_DATA_PREVIEW}}</h1>\n    </div>\n    <div class=\"modal-body\">\n        <div class=\"dialog-message\">{{{Strings.HEALTH_DATA_PREVIEW_INTRO}}}</div>\n\t\t<div class=\"dialog-message\">\n\t\t\t<label>\n\t            <input type=\"checkbox\" data-target=\"hdPref\" {{#hdPref}}checked{{/hdPref}} />\n\t            {{Strings.HEALTH_DATA_DO_TRACK}}\n\t        </label>\n\t\t\t<div style=\"display: flex; align-items: flex-start; gap: 8px; padding: 8px 10px; border-left: 3px solid #aaa; font-size: 13px; color: #666; margin: 8px 0;\">\n\t\t\t\t<span style=\"flex-shrink: 0;\">ℹ️</span>\n\t\t\t\t<span>{{Strings.HEALTH_DATA_PREVIEW_NECESSARY}}</span>\n\t\t\t</div>\n    \t</div>\n\t    <div class=\"dialog-message preview-content-container\">\n\t        <p class=\"preview-content\">{{{content}}}</p>\n\t    </div>\n\t</div>\n    <div class=\"modal-footer\">\n\t\t<button class=\"dialog-button btn\" data-button-id=\"clear\">{{Strings.RECENT_FILES_DLG_CLEAR_BUTTON_LABEL}}</button>\n\t\t<button class=\"dialog-button btn\" data-button-id=\"cancel\">{{Strings.CANCEL}}</button>\n        <button class=\"dialog-button btn primary\" data-button-id=\"save\">{{Strings.DONE}}</button>\n    </div>\n</div>\n`;\n\n    var prefs = PreferencesManager.getExtensionPrefs(\"healthData\");\n\n    ExtensionUtils.loadStyleSheet(module, \"styles.css\");\n\n    function _buildPreviewData() {\n        let content;\n        let auditData = Metrics.getLoggedDataForAudit();\n        let sortedData = new Map([...auditData.entries()].sort());\n        let displayData = [];\n        for (const [key, value] of sortedData.entries()) {\n            let valueString = \"\";\n            if(value.count > 1) {\n                valueString = `(${value.count})`;\n            }\n            if(value.eventType === Metrics.AUDIT_TYPE_COUNT){\n                displayData.push(`${key}  total: ${value.sum} ${valueString}`);\n            } else if(value.eventType === Metrics.AUDIT_TYPE_VALUE && value.count !== 0){\n                displayData.push(`${key}  avg: ${value.sum/value.count} ${valueString}`);\n            }\n        }\n        content = JSON.stringify(displayData, null, 2);\n        content = _.escape(content);\n        content = content.replace(/ /g, \"&nbsp;\");\n        content = content.replace(/(?:\\r\\n|\\r|\\n)/g, \"<br />\");\n        return content;\n    }\n\n    /**\n     * Show the dialog for previewing the Health Data that will be sent.\n     */\n    function previewHealthData() {\n        let hdPref   = prefs.get(\"healthDataTracking\"),\n            template = Mustache.render(HealthDataPreviewDialog,\n                {Strings: Strings, content: _buildPreviewData(), hdPref: hdPref}),\n            $template = $(template);\n\n        Dialogs.addLinkTooltips($template);\n        Dialogs.showModalDialogUsingTemplate($template).done(function (id) {\n\n            if (id === \"save\") {\n                var newHDPref = $template.find(\"[data-target]:checkbox\").is(\":checked\");\n                if (hdPref !== newHDPref) {\n                    prefs.set(\"healthDataTracking\", newHDPref);\n                }\n            } else if (id === 'clear'){\n                Metrics.clearAuditData();\n            }\n        });\n    }\n\n    exports.previewHealthData = previewHealthData;\n});\n\n/*\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n *\n */\n\n/*global AppConfig*/\ndefine(\"SendToAnalytics\", function (require, exports, module) {\n    const Metrics = brackets.getModule(\"utils/Metrics\"),\n        PreferencesManager  = brackets.getModule(\"preferences/PreferencesManager\"),\n        PerfUtils           = brackets.getModule(\"utils/PerfUtils\"),\n        NodeUtils           = brackets.getModule(\"utils/NodeUtils\"),\n        themesPref          = PreferencesManager.getExtensionPrefs(\"themes\");\n\n    const BugsnagPerformance = window.BugsnagPerformance;\n\n    const PLATFORM = Metrics.EVENT_TYPE.PLATFORM,\n        PERFORMANCE = Metrics.EVENT_TYPE.PERFORMANCE,\n        STORAGE = Metrics.EVENT_TYPE.STORAGE;\n\n    // Platform metrics to be sent at startup\n    function _emitDeviceTypeMetrics() {\n        if(brackets.browser.isDeskTop) {\n            Metrics.countEvent(PLATFORM, \"device\", \"desktop\");\n        }\n        if(brackets.browser.isMobile) {\n            Metrics.countEvent(PLATFORM, \"device\", \"mobile\");\n        }\n        if(brackets.browser.isTablet) {\n            Metrics.countEvent(PLATFORM, \"device\", \"tablet\");\n        }\n    }\n    function _emitMobileMetricsIfPresent() {\n        let platform = \"none\";\n        if(brackets.browser.mobile.isIos) {\n            platform = \"ios\";\n        } else if(brackets.browser.mobile.isWindows) {\n            platform = \"windows\";\n        } else if(brackets.browser.mobile.isAndroid) {\n            platform = \"android\";\n        } else {\n            return;\n        }\n        Metrics.countEvent(PLATFORM, \"mobile\", platform);\n    }\n    function _emitBrowserMetrics() {\n        if(brackets.browser.desktop.isChrome) {\n            Metrics.countEvent(PLATFORM, \"browser\", \"chrome\");\n        }\n        if(brackets.browser.desktop.isChromeBased) {\n            Metrics.countEvent(PLATFORM, \"browser\", \"chromeBased\");\n        }\n        if(brackets.browser.desktop.isEdgeChromium) {\n            Metrics.countEvent(PLATFORM, \"browser\", \"EdgeChromium\");\n        }\n        if(brackets.browser.desktop.isFirefox) {\n            Metrics.countEvent(PLATFORM, \"browser\", \"firefox\");\n        }\n        if(brackets.browser.desktop.isOpera) {\n            Metrics.countEvent(PLATFORM, \"browser\", \"opera\");\n        }\n        if(brackets.browser.desktop.isOperaChromium) {\n            Metrics.countEvent(PLATFORM, \"browser\", \"operaChromium\");\n        }\n    }\n\n    // web storage\n    async function _sendStorageMetrics() {\n        if (navigator.storage && navigator.storage.estimate) {\n            const quota = await navigator.storage.estimate();\n            // quota.usage -> Number of bytes used.\n            // quota.quota -> Maximum number of bytes available.\n            const percentageUsed = Math.round((quota.usage / quota.quota) * 100);\n            const usedMB = Math.round(quota.usage / 1024 / 1024);\n            console.log(`Web Storage quota used: ${percentageUsed}%, ${usedMB}MB`);\n            Metrics.valueEvent(STORAGE, \"browserQuota\", \"percentUsed\", percentageUsed);\n            Metrics.valueEvent(STORAGE, \"browserQuota\", \"usedMB\", usedMB);\n        }\n    }\n\n    function _getPlatformInfo() {\n        let OS = \"\";\n        if (/Windows|Win32|WOW64|Win64/.test(window.navigator.userAgent)) {\n            OS = \"WIN\";\n        } else if (/Mac/.test(window.navigator.userAgent)) {\n            OS = \"OSX\";\n        } else if (/Linux|X11/.test(window.navigator.userAgent)) {\n            OS = \"LINUX32\";\n            if (/x86_64/.test(window.navigator.appVersion + window.navigator.userAgent)) {\n                OS = \"LINUX64\";\n            }\n        }\n\n        return OS;\n    }\n\n    function sendPlatformMetrics() {\n        Metrics.countEvent(PLATFORM, \"os\", brackets.platform);\n        Metrics.countEvent(PLATFORM, \"userAgent\", window.navigator.userAgent);\n        Metrics.countEvent(PLATFORM, \"languageOS\", brackets.app.language);\n        Metrics.countEvent(PLATFORM, \"languageBrackets\", brackets.getLocale());\n        Metrics.countEvent(PLATFORM, \"bracketsVersion\", brackets.metadata.version);\n        if(Phoenix.platform === \"linux\" && Phoenix.isNativeApp) {\n            NodeUtils.getLinuxOSFlavorName()\n                .then(flavor=>{\n                    if(flavor){\n                        Metrics.countEvent(PLATFORM, \"os.flavor\", flavor);\n                    } else {\n                        Metrics.countEvent(PLATFORM, \"os.flavor\", _getPlatformInfo());\n                    }\n                });\n        } else {\n            Metrics.countEvent(PLATFORM, \"os.flavor\", _getPlatformInfo());\n        }\n        _emitDeviceTypeMetrics();\n        _emitBrowserMetrics();\n        _emitMobileMetricsIfPresent();\n        _sendStorageMetrics();\n    }\n\n    let bugsnagPerformanceInited = false;\n    function _initBugsnagPerformance() {\n        bugsnagPerformanceInited = true;\n        BugsnagPerformance.start({\n            apiKey: '94ef94f4daf871ca0f2fc912c6d4764d',\n            appVersion: AppConfig.version,\n            releaseStage: window.__TAURI__ ?\n                `tauri-${AppConfig.config.bugsnagEnv}-${Phoenix.platform}` : AppConfig.config.bugsnagEnv,\n            autoInstrumentRouteChanges: false,\n            autoInstrumentNetworkRequests: false,\n            autoInstrumentFullPageLoads: false\n        });\n    }\n\n    function _bugsnagPerformance(key, valueMs) {\n        if(Metrics.isDisabled() || !BugsnagPerformance || Phoenix.isTestWindow){\n            return;\n        }\n        if(!bugsnagPerformanceInited) {\n            _initBugsnagPerformance();\n        }\n        let activityStartTime = new Date();\n        let activityEndTime = new Date(activityStartTime.getTime() + valueMs);\n        BugsnagPerformance\n            .startSpan(key, { startTime: activityStartTime })\n            .end(activityEndTime);\n    }\n\n    // Performance\n    function sendStartupPerformanceMetrics() {\n        const healthReport = PerfUtils.getHealthReport();\n        let labelAppStart = \"AppStartupTime\";\n        if(Phoenix.firstBoot){\n            labelAppStart = \"FirstBootTime\";\n        }\n        Metrics.valueEvent(PERFORMANCE, \"startup\", labelAppStart,\n            Number(healthReport[\"AppStartupTime\"]));\n        _bugsnagPerformance(labelAppStart, Number(healthReport[\"AppStartupTime\"])); // expensive api, use sparsely\n        Metrics.valueEvent(PERFORMANCE, \"startup\", \"ModuleDepsResolved\",\n            Number(healthReport[\"ModuleDepsResolved\"]));\n        _bugsnagPerformance(\"ModuleDepsResolved\", Number(healthReport[\"ModuleDepsResolved\"])); // expensive api, use sparsely\n        Metrics.valueEvent(PERFORMANCE, \"startup\", \"PhStore\", PhStore._storageBootstrapTime);\n        _bugsnagPerformance(\"PhStore\",\n            PhStore._storageBootstrapTime); // expensive api, use sparsely\n        if(Phoenix.isNativeApp) {\n            Metrics.valueEvent(PERFORMANCE, \"startup\", \"tauriBoot\", window._tauriBootVars.bootstrapTime);\n            _bugsnagPerformance(\"tauriBootVars\",\n                window._tauriBootVars.bootstrapTime); // expensive api, use sparsely\n        }\n        if(window.nodeSetupDonePromise) {\n            window.nodeSetupDonePromise\n                .then(()=>{\n                    if(window.PhNodeEngine && window.PhNodeEngine._nodeLoadTime){\n                        Metrics.valueEvent(PERFORMANCE, \"startup\", \"nodeBoot\", window.PhNodeEngine._nodeLoadTime);\n                        _bugsnagPerformance(\"nodeBoot\",\n                            window.PhNodeEngine._nodeLoadTime); // expensive api, use sparsely\n                    }\n                    Metrics.countEvent(PERFORMANCE, \"nodeBoot\", \"success\", 1);\n                })\n                .catch(_err=>{\n                    Metrics.countEvent(PERFORMANCE, \"nodeBoot\", \"fail\", 1);\n                });\n        }\n    }\n\n    // Themes\n    function _getCurrentTheme() {\n        // TODO: currently phoenix only have default themes, but in future, we should ensure that only themes in the\n        //  registry and user installed are logged for privacy.\n        return themesPref.get(\"theme\") || \"default\";\n    }\n    function sendThemesMetrics() {\n        Metrics.countEvent(Metrics.EVENT_TYPE.THEMES, \"currentTheme\", _getCurrentTheme());\n    }\n\n    exports.sendPlatformMetrics = sendPlatformMetrics;\n    exports.sendStartupPerformanceMetrics = sendStartupPerformanceMetrics;\n    exports.sendThemesMetrics = sendThemesMetrics;\n    // TODO: send extension metrics\n});\n"],"file":"extension-min.js"}