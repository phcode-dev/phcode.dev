{"version":3,"sources":["extensions/default/Git/src/TabBarIntegration.js"],"names":["define","require","EventEmitter","Events","Git","Preferences","fileStatusCache","getFileStatus","fullPath","isModified","status","some","statusType","FILE_STATUS","MODIFIED","RENAMED","COPIED","isUntracked","includes","UNTRACKED","ADDED","STAGED","on","GIT_STATUS_RESULTS","files","gitRoot","get","forEach","entry","file","emit","GIT_DISABLED"],"mappings":"AAAAA,OAAO,SAAUC,SACb,MAAMC,aAAeD,QAAQ,oBACvBE,OAASF,QAAQ,cACjBG,IAAMH,QAAQ,eACdI,YAAcJ,QAAQ,mBAG5B,IAAIK,gBAAkB,GAQtB,SAASC,cAAcC,UACnB,OAAOF,gBAAgBE,WAAa,KASxC,SAASC,WAAWD,UAChB,MAAME,OAASH,cAAcC,UAC7B,QAAKE,QAGEA,OAAOC,KACTC,YACGA,aAAeR,IAAIS,YAAYC,UAC/BF,aAAeR,IAAIS,YAAYE,SAC/BH,aAAeR,IAAIS,YAAYG,QAU3C,SAASC,YAAYT,UACjB,MAAME,OAASH,cAAcC,UAC7B,QAAKE,SAMDA,OAAOQ,SAASd,IAAIS,YAAYM,YAC/BT,OAAOQ,SAASd,IAAIS,YAAYO,QAAUV,OAAOQ,SAASd,IAAIS,YAAYQ,SA+BnF,OAzBAnB,aAAaoB,GAAGnB,OAAOoB,mBAAoB,SAAUC,OAEjDlB,gBAAkB,GAElB,MAAMmB,QAAUpB,YAAYqB,IAAI,kBAC3BD,UAKLD,MAAMG,QAAQ,SAAUC,OACpB,MAAMpB,SAAWiB,QAAUG,MAAMC,KACjCvB,gBAAgBE,UAAYoB,MAAMlB,SAItCR,aAAa4B,KAAK,0BAA2BxB,oBAIjDJ,aAAaoB,GAAGnB,OAAO4B,aAAc,WACjCzB,gBAAkB,GAClBJ,aAAa4B,KAAK,0BAA2BxB,mBAG1C,CACHC,cAAeA,cACfE,WAAYA,WACZQ,YAAaA","sourcesContent":["define(function (require) {\n    const EventEmitter = require(\"src/EventEmitter\");\n    const Events = require(\"src/Events\");\n    const Git = require(\"src/git/Git\");\n    const Preferences = require(\"src/Preferences\");\n\n    // the cache of file statuses by path\n    let fileStatusCache = {};\n\n    /**\n     * this function is responsible to get the Git status for a file path\n     *\n     * @param {string} fullPath - the file path\n     * @returns {Array|null} - Array of status strings or null if no status\n     */\n    function getFileStatus(fullPath) {\n        return fileStatusCache[fullPath] || null;\n    }\n\n    /**\n     * whether the file is modified or not\n     *\n     * @param {string} fullPath - the file path\n     * @returns {boolean} - True if the file is modified otherwise false\n     */\n    function isModified(fullPath) {\n        const status = getFileStatus(fullPath);\n        if (!status) {\n            return false;\n        }\n        return status.some(\n            (statusType) =>\n                statusType === Git.FILE_STATUS.MODIFIED ||\n                statusType === Git.FILE_STATUS.RENAMED ||\n                statusType === Git.FILE_STATUS.COPIED\n        );\n    }\n\n    /**\n     * whether the file is untracked or not\n     *\n     * @param {string} fullPath - the file path\n     * @returns {boolean} - True if the file is untracked otherwise false\n     */\n    function isUntracked(fullPath) {\n        const status = getFileStatus(fullPath);\n        if (!status) {\n            return false;\n        }\n\n        // return true if it's untracked or if it's newly added (which means it was untracked before staging)\n        return (\n            status.includes(Git.FILE_STATUS.UNTRACKED) ||\n            (status.includes(Git.FILE_STATUS.ADDED) && status.includes(Git.FILE_STATUS.STAGED))\n        );\n    }\n\n\n    // Update file status cache when Git status results are received\n    EventEmitter.on(Events.GIT_STATUS_RESULTS, function (files) {\n        // reset the cache\n        fileStatusCache = {};\n\n        const gitRoot = Preferences.get(\"currentGitRoot\");\n        if (!gitRoot) {\n            return;\n        }\n\n        // we need to update cache with new status results\n        files.forEach(function (entry) {\n            const fullPath = gitRoot + entry.file;\n            fileStatusCache[fullPath] = entry.status;\n        });\n\n        // notify that file statuses have been updated\n        EventEmitter.emit(\"GIT_FILE_STATUS_CHANGED\", fileStatusCache);\n    });\n\n    // clear cache when Git is disabled\n    EventEmitter.on(Events.GIT_DISABLED, function () {\n        fileStatusCache = {};\n        EventEmitter.emit(\"GIT_FILE_STATUS_CHANGED\", fileStatusCache);\n    });\n\n    return {\n        getFileStatus: getFileStatus,\n        isModified: isModified,\n        isUntracked: isUntracked\n    };\n});\n"],"file":"TabBarIntegration.js"}