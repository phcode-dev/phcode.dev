define(function(require,exports){const Dialogs=brackets.getModule("widgets/Dialogs"),Mustache=brackets.getModule("thirdparty/mustache/mustache"),Preferences=require("src/Preferences"),RemoteCommon=require("src/dialogs/RemoteCommon"),Strings=brackets.getModule("strings"),template=require("text!src/dialogs/templates/pull-dialog.html"),remotesTemplate=require("text!src/dialogs/templates/remotes-template.html");function _attachEvents($dialog,pullConfig){RemoteCommon.attachCommonEvents(pullConfig,$dialog),$dialog.find("input[name='strategy']").filter("[value='"+(Preferences.get("pull.strategy")||"DEFAULT")+"']").prop("checked",!0)}function _show(pullConfig,resolve,reject){const templateArgs={config:pullConfig,mode:"PULL_FROM",modeLabel:Strings.PULL_FROM,Strings:Strings},compiledTemplate=Mustache.render(template,templateArgs,{remotes:remotesTemplate}),dialog=Dialogs.showModalDialogUsingTemplate(compiledTemplate),$dialog=dialog.getElement();_attachEvents($dialog,pullConfig),dialog.done(function(buttonId){"ok"===buttonId?(RemoteCommon.collectValues(pullConfig,$dialog),Preferences.set("pull.strategy",pullConfig.strategy),resolve(pullConfig)):reject()})}function show(pullConfig){return new Promise((resolve,reject)=>{pullConfig.pull=!0,RemoteCommon.collectInfo(pullConfig).then(()=>{_show(pullConfig,resolve,reject)})})}exports.show=show});